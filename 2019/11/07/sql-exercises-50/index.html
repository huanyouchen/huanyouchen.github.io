<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="python，Java，hacker"><title>sql常见面试50题练习 | 幻悠尘的小窝</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/normalize.css/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-118684665-1','auto');ga('send','pageview');
</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = 'https://hm.baidu.com/hm.js?' + '6630ddc4c60afb15b88971c6ab1d81a8';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script><script type="text/javascript" src="//cdn.jsdelivr.net/npm/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.css"><meta name="generator" content="Hexo 4.2.1"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">sql常见面试50题练习</h1><a id="logo" href="/.">幻悠尘的小窝</a><p class="description">The quieter you become,the more you are able to hear.</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/tags/"><i class="fa fa-tags"> 标签</i></a><a href="/projects/"><i class="fa fa-github"> 作品</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/message-board/"><i class="fa fa-comments"> 留言</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-4-4"><div class="content_container"><div class="post"><h1 class="post-title">sql常见面试50题练习</h1><div class="post-content"><p>网上流行的sql常见面试50题练习。本文使用的数据库为MySQL 8.0。</p>
<h3 id="测试数据介绍"><a href="#测试数据介绍" class="headerlink" title="测试数据介绍"></a>测试数据介绍</h3><p>学生表 Student(SId,Sname,Sage,Ssex)。–SId 学生编号,Sname 学生姓名,Sage 出生年月,Ssex 学生性别</p>
<p>课程表 Course(CId,Cname,TId) –CId –课程编号,Cname 课程名称,TId 教师编号</p>
<p>教师表 Teacher(TId,Tname) –TId 教师编号,Tname 教师姓名</p>
<p>成绩表 Score(SId,CId,score) –SId 学生编号,CId 课程编号,score 分数</p>
<a id="more"></a>

<p>测试数据：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--建表</span></span><br><span class="line"><span class="comment">--学生表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`Student`</span>(</span><br><span class="line">	<span class="string">`SId`</span> <span class="built_in">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">	<span class="string">`Sname`</span> <span class="built_in">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span>,</span><br><span class="line">	<span class="string">`Sage`</span> <span class="built_in">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span>,</span><br><span class="line">	<span class="string">`Ssex`</span> <span class="built_in">VARCHAR</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span>,</span><br><span class="line">	PRIMARY <span class="keyword">KEY</span>(<span class="string">`s_id`</span>)</span><br><span class="line">);</span><br><span class="line"><span class="comment">--课程表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`Course`</span>(</span><br><span class="line">	<span class="string">`CId`</span>  <span class="built_in">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">	<span class="string">`Cname`</span> <span class="built_in">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span>,</span><br><span class="line">	<span class="string">`TId`</span> <span class="built_in">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">	PRIMARY <span class="keyword">KEY</span>(<span class="string">`c_id`</span>)</span><br><span class="line">);</span><br><span class="line"><span class="comment">--教师表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`Teacher`</span>(</span><br><span class="line">	<span class="string">`Td`</span> <span class="built_in">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">	<span class="string">`Tname`</span> <span class="built_in">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">''</span>,</span><br><span class="line">	PRIMARY <span class="keyword">KEY</span>(<span class="string">`t_id`</span>)</span><br><span class="line">);</span><br><span class="line"><span class="comment">--成绩表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`Score`</span>(</span><br><span class="line">	<span class="string">`SId`</span> <span class="built_in">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">	<span class="string">`CId`</span>  <span class="built_in">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">	<span class="string">`score`</span> <span class="built_in">INT</span>(<span class="number">3</span>),</span><br><span class="line">	PRIMARY <span class="keyword">KEY</span>(<span class="string">`s_id`</span>,<span class="string">`c_id`</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">--插入学生表测试数据</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Student <span class="keyword">values</span>(<span class="string">'01'</span> , <span class="string">'赵雷'</span> , <span class="string">'1990-01-01'</span> , <span class="string">'男'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Student <span class="keyword">values</span>(<span class="string">'02'</span> , <span class="string">'钱电'</span> , <span class="string">'1990-12-21'</span> , <span class="string">'男'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Student <span class="keyword">values</span>(<span class="string">'03'</span> , <span class="string">'孙风'</span> , <span class="string">'1990-12-20'</span> , <span class="string">'男'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Student <span class="keyword">values</span>(<span class="string">'04'</span> , <span class="string">'李云'</span> , <span class="string">'1990-12-06'</span> , <span class="string">'男'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Student <span class="keyword">values</span>(<span class="string">'05'</span> , <span class="string">'周梅'</span> , <span class="string">'1991-12-01'</span> , <span class="string">'女'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Student <span class="keyword">values</span>(<span class="string">'06'</span> , <span class="string">'吴兰'</span> , <span class="string">'1992-01-01'</span> , <span class="string">'女'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Student <span class="keyword">values</span>(<span class="string">'07'</span> , <span class="string">'郑竹'</span> , <span class="string">'1989-01-01'</span> , <span class="string">'女'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Student <span class="keyword">values</span>(<span class="string">'08'</span> , <span class="string">'王菊'</span> , <span class="string">'1990-01-20'</span> , <span class="string">'女'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Student <span class="keyword">values</span>(<span class="string">'09'</span> , <span class="string">'张三'</span> , <span class="string">'2017-12-20'</span> , <span class="string">'女'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Student <span class="keyword">values</span>(<span class="string">'10'</span> , <span class="string">'李四'</span> , <span class="string">'2017-12-25'</span> , <span class="string">'女'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Student <span class="keyword">values</span>(<span class="string">'11'</span> , <span class="string">'李四'</span> , <span class="string">'2012-06-06'</span> , <span class="string">'女'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Student <span class="keyword">values</span>(<span class="string">'12'</span> , <span class="string">'赵六'</span> , <span class="string">'2013-06-13'</span> , <span class="string">'女'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Student <span class="keyword">values</span>(<span class="string">'13'</span> , <span class="string">'孙七'</span> , <span class="string">'2014-06-01'</span> , <span class="string">'女'</span>);</span><br><span class="line"><span class="comment">--课程表测试数据</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Course <span class="keyword">values</span>(<span class="string">'01'</span> , <span class="string">'语文'</span> , <span class="string">'02'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Course <span class="keyword">values</span>(<span class="string">'02'</span> , <span class="string">'数学'</span> , <span class="string">'01'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Course <span class="keyword">values</span>(<span class="string">'03'</span> , <span class="string">'英语'</span> , <span class="string">'03'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--教师表测试数据</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Teacher <span class="keyword">values</span>(<span class="string">'01'</span> , <span class="string">'张三'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Teacher <span class="keyword">values</span>(<span class="string">'02'</span> , <span class="string">'李四'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Teacher <span class="keyword">values</span>(<span class="string">'03'</span> , <span class="string">'王五'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--成绩表测试数据</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Score <span class="keyword">values</span>(<span class="string">'01'</span> , <span class="string">'01'</span> , <span class="number">80</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Score <span class="keyword">values</span>(<span class="string">'01'</span> , <span class="string">'02'</span> , <span class="number">90</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Score <span class="keyword">values</span>(<span class="string">'01'</span> , <span class="string">'03'</span> , <span class="number">99</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Score <span class="keyword">values</span>(<span class="string">'02'</span> , <span class="string">'01'</span> , <span class="number">70</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Score <span class="keyword">values</span>(<span class="string">'02'</span> , <span class="string">'02'</span> , <span class="number">60</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Score <span class="keyword">values</span>(<span class="string">'02'</span> , <span class="string">'03'</span> , <span class="number">80</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Score <span class="keyword">values</span>(<span class="string">'03'</span> , <span class="string">'01'</span> , <span class="number">80</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Score <span class="keyword">values</span>(<span class="string">'03'</span> , <span class="string">'02'</span> , <span class="number">80</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Score <span class="keyword">values</span>(<span class="string">'03'</span> , <span class="string">'03'</span> , <span class="number">80</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Score <span class="keyword">values</span>(<span class="string">'04'</span> , <span class="string">'01'</span> , <span class="number">50</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Score <span class="keyword">values</span>(<span class="string">'04'</span> , <span class="string">'02'</span> , <span class="number">30</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Score <span class="keyword">values</span>(<span class="string">'04'</span> , <span class="string">'03'</span> , <span class="number">20</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Score <span class="keyword">values</span>(<span class="string">'05'</span> , <span class="string">'01'</span> , <span class="number">76</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Score <span class="keyword">values</span>(<span class="string">'05'</span> , <span class="string">'02'</span> , <span class="number">87</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Score <span class="keyword">values</span>(<span class="string">'06'</span> , <span class="string">'01'</span> , <span class="number">31</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Score <span class="keyword">values</span>(<span class="string">'06'</span> , <span class="string">'03'</span> , <span class="number">34</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Score <span class="keyword">values</span>(<span class="string">'07'</span> , <span class="string">'02'</span> , <span class="number">89</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> Score <span class="keyword">values</span>(<span class="string">'07'</span> , <span class="string">'03'</span> , <span class="number">98</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--Student表内容：</span></span><br><span class="line">mysql&gt; SELECT * FROM Student ORDER BY SId;</span><br><span class="line">+<span class="comment">------+--------+---------------------+------+</span></span><br><span class="line">| SId  | Sname  | Sage                | Ssex |</span><br><span class="line">+<span class="comment">------+--------+---------------------+------+</span></span><br><span class="line">| 01   | 赵雷   | 1990-01-01 00:00:00 | 男   |</span><br><span class="line">| 02   | 钱电   | 1990-12-21 00:00:00 | 男   |</span><br><span class="line">| 03   | 孙风   | 1990-12-20 00:00:00 | 男   |</span><br><span class="line">| 04   | 李云   | 1990-12-06 00:00:00 | 男   |</span><br><span class="line">| 05   | 周梅   | 1991-12-01 00:00:00 | 女   |</span><br><span class="line">| 06   | 吴兰   | 1992-01-01 00:00:00 | 女   |</span><br><span class="line">| 07   | 郑竹   | 1989-01-01 00:00:00 | 女   |</span><br><span class="line">| 09   | 张三   | 2017-12-20 00:00:00 | 女   |</span><br><span class="line">| 10   | 李四   | 2017-12-25 00:00:00 | 女   |</span><br><span class="line">| 11   | 李四   | 2012-06-06 00:00:00 | 女   |</span><br><span class="line">| 12   | 赵六   | 2013-06-13 00:00:00 | 女   |</span><br><span class="line">| 13   | 孙七   | 2014-06-01 00:00:00 | 女   |</span><br><span class="line">+<span class="comment">------+--------+---------------------+------+</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--分数表内容：</span></span><br><span class="line">mysql&gt; SELECT * FROM Score ORDER BY SId, CId, score DESC;</span><br><span class="line">+<span class="comment">------+------+-------+</span></span><br><span class="line">| SId  | CId  | score |</span><br><span class="line">+<span class="comment">------+------+-------+</span></span><br><span class="line">| 01   | 01   |  80.0 |</span><br><span class="line">| 01   | 02   |  90.0 |</span><br><span class="line">| 01   | 03   |  99.0 |</span><br><span class="line">| 02   | 01   |  70.0 |</span><br><span class="line">| 02   | 02   |  60.0 |</span><br><span class="line">| 02   | 03   |  80.0 |</span><br><span class="line">| 03   | 01   |  80.0 |</span><br><span class="line">| 03   | 02   |  80.0 |</span><br><span class="line">| 03   | 03   |  80.0 |</span><br><span class="line">| 04   | 01   |  50.0 |</span><br><span class="line">| 04   | 02   |  30.0 |</span><br><span class="line">| 04   | 03   |  20.0 |</span><br><span class="line">| 05   | 01   |  76.0 |</span><br><span class="line">| 05   | 02   |  87.0 |</span><br><span class="line">| 06   | 01   |  31.0 |</span><br><span class="line">| 06   | 03   |  34.0 |</span><br><span class="line">| 07   | 02   |  89.0 |</span><br><span class="line">| 07   | 03   |  98.0 |</span><br><span class="line">+<span class="comment">------+------+-------+</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--课程表内容：</span></span><br><span class="line">mysql&gt; SELECT * FROM Course ORDER BY CId;</span><br><span class="line">+<span class="comment">------+--------+------+</span></span><br><span class="line">| CId  | Cname  | TId  |</span><br><span class="line">+<span class="comment">------+--------+------+</span></span><br><span class="line">| 01   | 语文   | 02   |</span><br><span class="line">| 02   | 数学   | 01   |</span><br><span class="line">| 03   | 英语   | 03   |</span><br><span class="line">+<span class="comment">------+--------+------+</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--教师表内容：</span></span><br><span class="line">mysql&gt; SELECT * FROM Teacher;</span><br><span class="line">+<span class="comment">------+--------+</span></span><br><span class="line">| TId  | Tname  |</span><br><span class="line">+<span class="comment">------+--------+</span></span><br><span class="line">| 01   | 张三   |</span><br><span class="line">| 02   | 李四   |</span><br><span class="line">| 03   | 王五   |</span><br><span class="line">+<span class="comment">------+--------+</span></span><br></pre></td></tr></table></figure>
<h3 id="1-查询”-01-“课程比”-02-“课程成绩高的学生的信息及课程分数"><a href="#1-查询”-01-“课程比”-02-“课程成绩高的学生的信息及课程分数" class="headerlink" title="1. 查询” 01 “课程比” 02 “课程成绩高的学生的信息及课程分数"></a>1. 查询” 01 “课程比” 02 “课程成绩高的学生的信息及课程分数</h3><p>解题思路：</p>
<p>首先找出选了01课程和02课程的学生及分数：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * </span><br><span class="line"><span class="keyword">FROM</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">SId</span>, CId, score</span><br><span class="line">    <span class="keyword">FROM</span> Score</span><br><span class="line">    <span class="keyword">WHERE</span> CId = <span class="string">'01'</span></span><br><span class="line">) <span class="keyword">AS</span> a</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">SId</span>, CId, score</span><br><span class="line">    <span class="keyword">FROM</span> Score</span><br><span class="line">    <span class="keyword">WHERE</span> CId = <span class="string">'02'</span></span><br><span class="line">) <span class="keyword">AS</span> b</span><br><span class="line"><span class="keyword">ON</span> a.SId = b.SId;</span><br></pre></td></tr></table></figure>
<p>得到信息如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+------+------+-------+------+------+-------+</span><br><span class="line">| SId  | CId  | score | SId  | CId  | score |</span><br><span class="line">+------+------+-------+------+------+-------+</span><br><span class="line">| 01   | 01   |  80.0 | 01   | 02   |  90.0 |</span><br><span class="line">| 02   | 01   |  70.0 | 02   | 02   |  60.0 |</span><br><span class="line">| 03   | 01   |  80.0 | 03   | 02   |  80.0 |</span><br><span class="line">| 04   | 01   |  50.0 | 04   | 02   |  30.0 |</span><br><span class="line">| 05   | 01   |  76.0 | 05   | 02   |  87.0 |</span><br><span class="line">+------+------+-------+------+------+-------+</span><br></pre></td></tr></table></figure>
<p>然后把这个表和学生信息表连接:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> Student <span class="keyword">AS</span> s</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> </span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">SELECT</span> <span class="keyword">SId</span>, CId, score</span><br><span class="line">        <span class="keyword">FROM</span> Score</span><br><span class="line">        <span class="keyword">WHERE</span> CId = <span class="string">'01'</span></span><br><span class="line">    ) <span class="keyword">AS</span> a</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> </span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">SELECT</span> <span class="keyword">SId</span>, CId, score</span><br><span class="line">        <span class="keyword">FROM</span> Score</span><br><span class="line">        <span class="keyword">WHERE</span> CId = <span class="string">'02'</span></span><br><span class="line">    ) <span class="keyword">AS</span> b</span><br><span class="line"><span class="keyword">ON</span> s.SId = a.SId</span><br><span class="line"><span class="keyword">AND</span> a.SId = b.SId;</span><br></pre></td></tr></table></figure>
<p>得到如下信息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+------+------+-------+------+------+-------+</span><br><span class="line">| SId  | Sname  | Sage                | Ssex | SId  | CId  | score | SId  | CId  | score |</span><br><span class="line">+------+--------+---------------------+------+------+------+-------+------+------+-------+</span><br><span class="line">| 01   | 赵雷   | 1990-01-01 00:00:00 | 男   | 01   | 01   |  80.0 | 01   | 02   |  90.0 |</span><br><span class="line">| 02   | 钱电   | 1990-12-21 00:00:00 | 男   | 02   | 01   |  70.0 | 02   | 02   |  60.0 |</span><br><span class="line">| 03   | 孙风   | 1990-12-20 00:00:00 | 男   | 03   | 01   |  80.0 | 03   | 02   |  80.0 |</span><br><span class="line">| 04   | 李云   | 1990-12-06 00:00:00 | 男   | 04   | 01   |  50.0 | 04   | 02   |  30.0 |</span><br><span class="line">| 05   | 周梅   | 1991-12-01 00:00:00 | 女   | 05   | 01   |  76.0 | 05   | 02   |  87.0 |</span><br><span class="line">+------+--------+---------------------+------+------+------+-------+------+------+-------+</span><br></pre></td></tr></table></figure>
<p>最后使用where条件，过滤出01课程分数大于02课程分数的。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> s.*, a.score <span class="keyword">AS</span> <span class="string">"01课程成绩"</span>, b.score <span class="keyword">AS</span> <span class="string">"02课程成绩"</span></span><br><span class="line"><span class="keyword">FROM</span> Student <span class="keyword">AS</span> s</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> </span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">SELECT</span> <span class="keyword">SId</span>, CId, score</span><br><span class="line">        <span class="keyword">FROM</span> Score</span><br><span class="line">        <span class="keyword">WHERE</span> CId = <span class="string">'01'</span></span><br><span class="line">    ) <span class="keyword">AS</span> a</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> </span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">SELECT</span> <span class="keyword">SId</span>, CId, score</span><br><span class="line">        <span class="keyword">FROM</span> Score</span><br><span class="line">        <span class="keyword">WHERE</span> CId = <span class="string">'02'</span></span><br><span class="line">    ) <span class="keyword">AS</span> b</span><br><span class="line"><span class="keyword">ON</span> s.SId = a.SId</span><br><span class="line"><span class="keyword">AND</span> a.SId = b.SId</span><br><span class="line"><span class="keyword">WHERE</span> a.score &gt; b.score;</span><br></pre></td></tr></table></figure>
<p>最终结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+----------------+----------------+</span><br><span class="line">| SId  | Sname  | Sage                | Ssex | 01课程成绩     | 02课程成绩     |</span><br><span class="line">+------+--------+---------------------+------+----------------+----------------+</span><br><span class="line">| 02   | 钱电   | 1990-12-21 00:00:00 | 男   |           70.0 |           60.0 |</span><br><span class="line">| 04   | 李云   | 1990-12-06 00:00:00 | 男   |           50.0 |           30.0 |</span><br><span class="line">+------+--------+---------------------+------+----------------+----------------+</span><br></pre></td></tr></table></figure>

<h3 id="2-查询”-01-“课程比”-02-“课程成绩低的学生的信息及课程分数"><a href="#2-查询”-01-“课程比”-02-“课程成绩低的学生的信息及课程分数" class="headerlink" title="2. 查询” 01 “课程比” 02 “课程成绩低的学生的信息及课程分数"></a>2. 查询” 01 “课程比” 02 “课程成绩低的学生的信息及课程分数</h3><p>思路：与上一题类似<br>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s.*, a.score <span class="keyword">AS</span> <span class="string">"01课程成绩"</span>, b.score <span class="keyword">AS</span> <span class="string">"02课程成绩"</span></span><br><span class="line"><span class="keyword">FROM</span> Student <span class="keyword">AS</span> s</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> </span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">SELECT</span> <span class="keyword">SId</span>, CId, score</span><br><span class="line">        <span class="keyword">FROM</span> Score</span><br><span class="line">        <span class="keyword">WHERE</span> CId = <span class="string">'01'</span></span><br><span class="line">    ) <span class="keyword">AS</span> a</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> </span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">SELECT</span> <span class="keyword">SId</span>, CId, score</span><br><span class="line">        <span class="keyword">FROM</span> Score</span><br><span class="line">        <span class="keyword">WHERE</span> CId = <span class="string">'02'</span></span><br><span class="line">    ) <span class="keyword">AS</span> b</span><br><span class="line"><span class="keyword">ON</span> s.SId = a.SId</span><br><span class="line"><span class="keyword">AND</span> a.SId = b.SId</span><br><span class="line"><span class="keyword">WHERE</span> a.score &lt; b.score;</span><br></pre></td></tr></table></figure>
<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+----------------+----------------+</span><br><span class="line">| SId  | Sname  | Sage                | Ssex | 01课程成绩     | 02课程成绩     |</span><br><span class="line">+------+--------+---------------------+------+----------------+----------------+</span><br><span class="line">| 01   | 赵雷   | 1990-01-01 00:00:00 | 男   |           80.0 |           90.0 |</span><br><span class="line">| 05   | 周梅   | 1991-12-01 00:00:00 | 女   |           76.0 |           87.0 |</span><br><span class="line">+------+--------+---------------------+------+----------------+----------------+</span><br></pre></td></tr></table></figure>

<h3 id="3-查询同时选了”-01-“课程和”-02-“课程的情况"><a href="#3-查询同时选了”-01-“课程和”-02-“课程的情况" class="headerlink" title="3. 查询同时选了” 01 “课程和” 02 “课程的情况"></a>3. 查询同时选了” 01 “课程和” 02 “课程的情况</h3><p>解题思路：找出选了01课程的表a，找出选了02课程的表b，把这两表连接，其中学生SId相同。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * </span><br><span class="line"><span class="keyword">FROM</span> (</span><br><span class="line">        <span class="keyword">SELECT</span> <span class="keyword">SId</span>, CId, score <span class="keyword">AS</span> <span class="string">"01课程成绩"</span></span><br><span class="line">        <span class="keyword">FROM</span> Score</span><br><span class="line">        <span class="keyword">WHERE</span> CId = <span class="string">'01'</span></span><br><span class="line">    ) <span class="keyword">AS</span> a</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> </span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">SELECT</span> <span class="keyword">SId</span>, CId, score <span class="keyword">AS</span> <span class="string">"02课程成绩"</span></span><br><span class="line">        <span class="keyword">FROM</span> Score</span><br><span class="line">        <span class="keyword">WHERE</span> CId = <span class="string">'02'</span></span><br><span class="line">    ) <span class="keyword">AS</span> b</span><br><span class="line"><span class="keyword">ON</span> a.SId = b.SId;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+------+------+----------------+------+------+----------------+</span><br><span class="line">| SId  | CId  | 01课程成绩     | SId  | CId  | 02课程成绩     |</span><br><span class="line">+------+------+----------------+------+------+----------------+</span><br><span class="line">| 01   | 01   |           80.0 | 01   | 02   |           90.0 |</span><br><span class="line">| 02   | 01   |           70.0 | 02   | 02   |           60.0 |</span><br><span class="line">| 03   | 01   |           80.0 | 03   | 02   |           80.0 |</span><br><span class="line">| 04   | 01   |           50.0 | 04   | 02   |           30.0 |</span><br><span class="line">| 05   | 01   |           76.0 | 05   | 02   |           87.0 |</span><br><span class="line">+------+------+----------------+------+------+----------------+</span><br></pre></td></tr></table></figure>

<h3 id="4-查询不存在”-01-“课程但存在”-02-“课程的情况"><a href="#4-查询不存在”-01-“课程但存在”-02-“课程的情况" class="headerlink" title="4. 查询不存在” 01 “课程但存在” 02 “课程的情况"></a>4. 查询不存在” 01 “课程但存在” 02 “课程的情况</h3><p>解题思路：找出选择了02课程的学生，这些学生不在(NOT IN)选了01课程的学生名单中。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">SId</span>, CId, score <span class="keyword">AS</span> <span class="string">"02课程成绩"</span></span><br><span class="line"><span class="keyword">FROM</span> Score</span><br><span class="line"><span class="keyword">WHERE</span> CId = <span class="string">'02'</span></span><br><span class="line"><span class="keyword">AND</span> <span class="keyword">SId</span> <span class="keyword">NOT</span> <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">SId</span></span><br><span class="line">    <span class="keyword">FROM</span> Score</span><br><span class="line">    <span class="keyword">WHERE</span> CId = <span class="string">'01'</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+------+------+----------------+</span><br><span class="line">| SId  | CId  | 02课程成绩     |</span><br><span class="line">+------+------+----------------+</span><br><span class="line">| 07   | 02   |           89.0 |</span><br><span class="line">+------+------+----------------+</span><br></pre></td></tr></table></figure>
<h3 id="5-查询学过编号为”01”但是没有学过编号为”02”的课程的同学的信息"><a href="#5-查询学过编号为”01”但是没有学过编号为”02”的课程的同学的信息" class="headerlink" title="5. 查询学过编号为”01”但是没有学过编号为”02”的课程的同学的信息"></a>5. 查询学过编号为”01”但是没有学过编号为”02”的课程的同学的信息</h3><p>解题思路：和4题类似，只是需要额外与Student表连接，找出学生信息</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s.*, t.CId, t.score <span class="keyword">AS</span> <span class="string">"01课程成绩"</span></span><br><span class="line"><span class="keyword">FROM</span> Student <span class="keyword">AS</span> s </span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> </span><br><span class="line">    (</span><br><span class="line">        <span class="keyword">SELECT</span> *</span><br><span class="line">        <span class="keyword">FROM</span> Score</span><br><span class="line">        <span class="keyword">WHERE</span> CId = <span class="string">'01'</span></span><br><span class="line">        <span class="keyword">AND</span> <span class="keyword">SId</span> <span class="keyword">NOT</span> <span class="keyword">IN</span> </span><br><span class="line">        (</span><br><span class="line">            <span class="keyword">SELECT</span> <span class="keyword">SId</span></span><br><span class="line">            <span class="keyword">FROM</span> Score</span><br><span class="line">            <span class="keyword">WHERE</span> CId = <span class="string">'02'</span></span><br><span class="line">        ) </span><br><span class="line">    )<span class="keyword">AS</span> t</span><br><span class="line"><span class="keyword">ON</span> s.SId = t.SId;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+------+----------------+</span><br><span class="line">| SId  | Sname  | Sage                | Ssex | CId  | 01课程成绩     |</span><br><span class="line">+------+--------+---------------------+------+------+----------------+</span><br><span class="line">| 06   | 吴兰   | 1992-01-01 00:00:00 | 女   | 01   |           31.0 |</span><br><span class="line">+------+--------+---------------------+------+------+----------------+</span><br></pre></td></tr></table></figure>

<h3 id="6-查询存在”-01-“课程但可能不存在”-02-“课程的情况-不存在时显示为null"><a href="#6-查询存在”-01-“课程但可能不存在”-02-“课程的情况-不存在时显示为null" class="headerlink" title="6. 查询存在” 01 “课程但可能不存在” 02 “课程的情况(不存在时显示为null)"></a>6. 查询存在” 01 “课程但可能不存在” 02 “课程的情况(不存在时显示为null)</h3><p>解题思路：找出选01课程的课程信息表a，找出选了02课程的课程信息表b，以表a为主表，使用LEFT JOIN连接，</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">(</span><br><span class="line">    <span class="keyword">SELECT</span> *</span><br><span class="line">    <span class="keyword">FROM</span> Score</span><br><span class="line">    <span class="keyword">WHERE</span> CId = <span class="string">'01'</span></span><br><span class="line">) <span class="keyword">AS</span> a</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span></span><br><span class="line">(</span><br><span class="line">    <span class="keyword">SELECT</span> *</span><br><span class="line">    <span class="keyword">FROM</span> Score</span><br><span class="line">    <span class="keyword">WHERE</span> CId = <span class="string">'02'</span></span><br><span class="line">) <span class="keyword">AS</span> b</span><br><span class="line"><span class="keyword">ON</span> a.SId = b.SId;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+------+------+-------+------+------+-------+</span><br><span class="line">| SId  | CId  | score | SId  | CId  | score |</span><br><span class="line">+------+------+-------+------+------+-------+</span><br><span class="line">| 01   | 01   |  80.0 | 01   | 02   |  90.0 |</span><br><span class="line">| 02   | 01   |  70.0 | 02   | 02   |  60.0 |</span><br><span class="line">| 03   | 01   |  80.0 | 03   | 02   |  80.0 |</span><br><span class="line">| 04   | 01   |  50.0 | 04   | 02   |  30.0 |</span><br><span class="line">| 05   | 01   |  76.0 | 05   | 02   |  87.0 |</span><br><span class="line">| 06   | 01   |  31.0 | NULL | NULL |  NULL |</span><br><span class="line">+------+------+-------+------+------+-------+</span><br></pre></td></tr></table></figure>
<h3 id="7-查询平均成绩大于等于-60-分的同学的学生编号和学生姓名和平均成绩"><a href="#7-查询平均成绩大于等于-60-分的同学的学生编号和学生姓名和平均成绩" class="headerlink" title="7. 查询平均成绩大于等于 60 分的同学的学生编号和学生姓名和平均成绩"></a>7. 查询平均成绩大于等于 60 分的同学的学生编号和学生姓名和平均成绩</h3><p>解题思路：涉及到student表和score表，先把这两张表连接起来。因为要求每个学生的各科的平均成绩，因此对学生分组，设置分组条件为平均成绩大于等于 60 分。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> st.SId, st.Sname, <span class="keyword">ROUND</span>(<span class="keyword">AVG</span>(sc.score), <span class="number">2</span>) <span class="keyword">as</span> <span class="string">'avg_score'</span></span><br><span class="line"><span class="keyword">FROM</span> Score <span class="keyword">AS</span> sc <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Student <span class="keyword">AS</span> st</span><br><span class="line"><span class="keyword">ON</span> sc.SId = st.SId</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> st.SId, st.Sname</span><br><span class="line"><span class="keyword">HAVING</span> avg_score &gt;= <span class="number">60</span>;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+-----------+</span><br><span class="line">| SId  | Sname  | avg_score |</span><br><span class="line">+------+--------+-----------+</span><br><span class="line">| 01   | 赵雷   |     89.67 |</span><br><span class="line">| 02   | 钱电   |     70.00 |</span><br><span class="line">| 03   | 孙风   |     80.00 |</span><br><span class="line">| 05   | 周梅   |     81.50 |</span><br><span class="line">| 07   | 郑竹   |     93.50 |</span><br><span class="line">+------+--------+-----------+</span><br></pre></td></tr></table></figure>

<h3 id="8-查询所有课程成绩小于-60-分的同学的学生编号和学生姓名和成绩，如果没有成绩，则显示null"><a href="#8-查询所有课程成绩小于-60-分的同学的学生编号和学生姓名和成绩，如果没有成绩，则显示null" class="headerlink" title="8. 查询所有课程成绩小于 60 分的同学的学生编号和学生姓名和成绩，如果没有成绩，则显示null"></a>8. 查询所有课程成绩小于 60 分的同学的学生编号和学生姓名和成绩，如果没有成绩，则显示null</h3><p>解题思路：成绩小于60分为两种情况，一种是有成绩，且小于60;另一种是没有成绩,对于这些学生，TA的SId存在但是score不存在，因此使用student表 LEFT JOIN score表。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> st.SId, st.Sname, sc.score</span><br><span class="line"><span class="keyword">FROM</span> Student <span class="keyword">AS</span> st <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Score <span class="keyword">AS</span> sc </span><br><span class="line"><span class="keyword">ON</span> sc.SId = st.SId</span><br><span class="line"><span class="keyword">WHERE</span> sc.score <span class="keyword">IS</span> <span class="literal">NULL</span> <span class="keyword">OR</span> sc.score &lt; <span class="number">60</span>;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+-------+</span><br><span class="line">| SId  | Sname  | score |</span><br><span class="line">+------+--------+-------+</span><br><span class="line">| 04   | 李云   |  50.0 |</span><br><span class="line">| 04   | 李云   |  30.0 |</span><br><span class="line">| 06   | 吴兰   |  31.0 |</span><br><span class="line">| 04   | 李云   |  20.0 |</span><br><span class="line">| 06   | 吴兰   |  34.0 |</span><br><span class="line">| 09   | 张三   |  NULL |</span><br><span class="line">| 10   | 李四   |  NULL |</span><br><span class="line">| 11   | 李四   |  NULL |</span><br><span class="line">| 12   | 赵六   |  NULL |</span><br><span class="line">| 13   | 孙七   |  NULL |</span><br><span class="line">+------+--------+-------+</span><br></pre></td></tr></table></figure>

<h3 id="9-查询在-Score-表存在成绩的学生信息"><a href="#9-查询在-Score-表存在成绩的学生信息" class="headerlink" title="9. 查询在 Score 表存在成绩的学生信息"></a>9. 查询在 Score 表存在成绩的学生信息</h3><p>解题思路：有两种方法，一种是用IN, (Student表中的学生ID) IN (Score表中存在成绩的学生ID)。<br>第二种方法是把两个表连接，以Student表为主表，左连接Score，如果不存在成绩那么score为null，存在成绩，则score IS NOT NULL</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 方法一</span></span><br><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">SId</span> <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">SId</span></span><br><span class="line">    <span class="keyword">FROM</span> Score</span><br><span class="line">    <span class="keyword">WHERE</span> score <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 方法二</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> st.*</span><br><span class="line"><span class="keyword">FROM</span> Student <span class="keyword">AS</span> st <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Score <span class="keyword">AS</span> sc <span class="keyword">ON</span> st.SId=sc.SId </span><br><span class="line"><span class="keyword">WHERE</span> sc.score <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+</span><br><span class="line">| SId  | Sname  | Sage                | Ssex |</span><br><span class="line">+------+--------+---------------------+------+</span><br><span class="line">| 01   | 赵雷   | 1990-01-01 00:00:00 | 男   |</span><br><span class="line">| 02   | 钱电   | 1990-12-21 00:00:00 | 男   |</span><br><span class="line">| 03   | 孙风   | 1990-12-20 00:00:00 | 男   |</span><br><span class="line">| 04   | 李云   | 1990-12-06 00:00:00 | 男   |</span><br><span class="line">| 05   | 周梅   | 1991-12-01 00:00:00 | 女   |</span><br><span class="line">| 06   | 吴兰   | 1992-01-01 00:00:00 | 女   |</span><br><span class="line">| 07   | 郑竹   | 1989-01-01 00:00:00 | 女   |</span><br><span class="line">+------+--------+---------------------+------+</span><br></pre></td></tr></table></figure>

<h3 id="10-查询所有同学的学生编号、学生姓名、选课总数、所有课程的总成绩-没成绩的显示为-0"><a href="#10-查询所有同学的学生编号、学生姓名、选课总数、所有课程的总成绩-没成绩的显示为-0" class="headerlink" title="10. 查询所有同学的学生编号、学生姓名、选课总数、所有课程的总成绩(没成绩的显示为 0 )"></a>10. 查询所有同学的学生编号、学生姓名、选课总数、所有课程的总成绩(没成绩的显示为 0 )</h3><p>解题思路：把student表和score表连接，其中部分学生没有成绩，即score=null。然后把学生分组，计算每个学生的选课总数和总成绩。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> st.SId, st.Sname, <span class="keyword">COUNT</span>(sc.CId) <span class="keyword">AS</span> <span class="string">'选课总数'</span>, <span class="keyword">CAST</span>(<span class="keyword">SUM</span>(<span class="keyword">COALESCE</span>(sc.score, <span class="number">0</span>)) <span class="keyword">as</span> <span class="built_in">real</span>) <span class="keyword">AS</span> <span class="string">'总成绩'</span></span><br><span class="line"><span class="keyword">FROM</span> Student <span class="keyword">AS</span> st <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Score <span class="keyword">AS</span> sc</span><br><span class="line"><span class="keyword">ON</span> st.SId = sc.SId</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> st.SId, st.Sname;</span><br></pre></td></tr></table></figure>
<p>这里使用了COALESCE()函数，返回参数中的第一个不为NULL的表达式（从左向右），如果传入的参数所有都是null，则返回null。</p>
<p>这个函数在这段sql语句中的作用是如果sc.score不是null，那么返回值是sc.score本身；如果sc.score是null，那么返回给定值0。</p>
<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+--------------+-----------+</span><br><span class="line">| SId  | Sname  | 选课总数     | 总成绩    |</span><br><span class="line">+------+--------+--------------+-----------+</span><br><span class="line">| 01   | 赵雷   |            3 |       269 |</span><br><span class="line">| 02   | 钱电   |            3 |       210 |</span><br><span class="line">| 03   | 孙风   |            3 |       240 |</span><br><span class="line">| 04   | 李云   |            3 |       100 |</span><br><span class="line">| 05   | 周梅   |            2 |       163 |</span><br><span class="line">| 06   | 吴兰   |            2 |        65 |</span><br><span class="line">| 07   | 郑竹   |            2 |       187 |</span><br><span class="line">| 09   | 张三   |            0 |         0 |</span><br><span class="line">| 10   | 李四   |            0 |         0 |</span><br><span class="line">| 11   | 李四   |            0 |         0 |</span><br><span class="line">| 12   | 赵六   |            0 |         0 |</span><br><span class="line">| 13   | 孙七   |            0 |         0 |</span><br><span class="line">+------+--------+--------------+-----------+</span><br></pre></td></tr></table></figure>

<h3 id="11-查询”李”姓老师的数量"><a href="#11-查询”李”姓老师的数量" class="headerlink" title="11.查询”李”姓老师的数量"></a>11.查询”李”姓老师的数量</h3><p>解题思路：使用LIKE关键字。在MySQL中，通配符<code>%</code>可以替代0个或多个字符，通配符<code>-</code>替代一个字符。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(TId) <span class="keyword">AS</span> <span class="string">'李老师数量'</span></span><br><span class="line"><span class="keyword">FROM</span> Teacher</span><br><span class="line"><span class="keyword">WHERE</span> Tname <span class="keyword">LIKE</span> <span class="string">'李%'</span>;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+-----------------+</span><br><span class="line">| 李老师数量      |</span><br><span class="line">+-----------------+</span><br><span class="line">|               1 |</span><br><span class="line">+-----------------+</span><br></pre></td></tr></table></figure>
<h3 id="12-查询学过「张三」老师授课的同学的信息"><a href="#12-查询学过「张三」老师授课的同学的信息" class="headerlink" title="12. 查询学过「张三」老师授课的同学的信息"></a>12. 查询学过「张三」老师授课的同学的信息</h3><p>解题思路：直接把四张表连接起来，使用教师名字作为WHERE条件过滤。或者把学生表和分数表连接，课程表和教师表连接，以课程ID作为过滤条件。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> st.*</span><br><span class="line"><span class="keyword">FROM</span> Student <span class="keyword">AS</span> st <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Score <span class="keyword">AS</span> sc</span><br><span class="line"><span class="keyword">ON</span> st.SId = sc.SId</span><br><span class="line"><span class="keyword">WHERE</span> sc.CId <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> C.CId</span><br><span class="line">    <span class="keyword">FROM</span> Course <span class="keyword">AS</span> C <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Teacher <span class="keyword">AS</span> T</span><br><span class="line">    <span class="keyword">ON</span> C.TId = T.TId</span><br><span class="line">    <span class="keyword">WHERE</span> T.Tname = <span class="string">'张三'</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+</span><br><span class="line">| SId  | Sname  | Sage                | Ssex |</span><br><span class="line">+------+--------+---------------------+------+</span><br><span class="line">| 01   | 赵雷   | 1990-01-01 00:00:00 | 男   |</span><br><span class="line">| 02   | 钱电   | 1990-12-21 00:00:00 | 男   |</span><br><span class="line">| 03   | 孙风   | 1990-12-20 00:00:00 | 男   |</span><br><span class="line">| 04   | 李云   | 1990-12-06 00:00:00 | 男   |</span><br><span class="line">| 05   | 周梅   | 1991-12-01 00:00:00 | 女   |</span><br><span class="line">| 07   | 郑竹   | 1989-01-01 00:00:00 | 女   |</span><br><span class="line">+------+--------+---------------------+------+</span><br></pre></td></tr></table></figure>

<h3 id="13-查询没学过「张三」老师授课的同学的信息"><a href="#13-查询没学过「张三」老师授课的同学的信息" class="headerlink" title="13. 查询没学过「张三」老师授课的同学的信息"></a>13. 查询没学过「张三」老师授课的同学的信息</h3><p>解题思路：先把所有学过张三课程的学生id找出来，过程是把course表，teacher表和score表连接，由教师名字-》教师号-》课程ID-》学生，最后在学生表中去掉这些学生，得到的就是没有学过张三课的学生。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> Student </span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">SId</span> <span class="keyword">NOT</span> <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> sc.SId</span><br><span class="line">    <span class="keyword">FROM</span> Course <span class="keyword">AS</span> C <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Teacher <span class="keyword">AS</span> T <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Score <span class="keyword">AS</span> sc</span><br><span class="line">    <span class="keyword">ON</span> C.TId = T.TId</span><br><span class="line">    <span class="keyword">AND</span> C.CId = sc.CId</span><br><span class="line">    <span class="keyword">WHERE</span> T.Tname = <span class="string">'张三'</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+</span><br><span class="line">| SId  | Sname  | Sage                | Ssex |</span><br><span class="line">+------+--------+---------------------+------+</span><br><span class="line">| 06   | 吴兰   | 1992-01-01 00:00:00 | 女   |</span><br><span class="line">| 09   | 张三   | 2017-12-20 00:00:00 | 女   |</span><br><span class="line">| 10   | 李四   | 2017-12-25 00:00:00 | 女   |</span><br><span class="line">| 11   | 李四   | 2012-06-06 00:00:00 | 女   |</span><br><span class="line">| 12   | 赵六   | 2013-06-13 00:00:00 | 女   |</span><br><span class="line">| 13   | 孙七   | 2014-06-01 00:00:00 | 女   |</span><br><span class="line">+------+--------+---------------------+------+</span><br></pre></td></tr></table></figure>
<h3 id="14-查询没有学全所有课程的同学的信息"><a href="#14-查询没有学全所有课程的同学的信息" class="headerlink" title="14. 查询没有学全所有课程的同学的信息"></a>14. 查询没有学全所有课程的同学的信息</h3><p>解题思路：先找出总共的课程数量。然后在成绩表中按学生号分组，查询每个学生学习的课程数量是否等于总课程数量。最后在学生信息表中去掉这些学全所有课程的同学，剩下的就是没有学全的。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">SId</span> <span class="keyword">NOT</span> <span class="keyword">IN</span></span><br><span class="line">(</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">SId</span></span><br><span class="line">    <span class="keyword">FROM</span> Score</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">SId</span></span><br><span class="line">    <span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(CId) = (<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(<span class="keyword">DISTINCT</span> CId) <span class="keyword">FROM</span> Course)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+</span><br><span class="line">| SId  | Sname  | Sage                | Ssex |</span><br><span class="line">+------+--------+---------------------+------+</span><br><span class="line">| 05   | 周梅   | 1991-12-01 00:00:00 | 女   |</span><br><span class="line">| 06   | 吴兰   | 1992-01-01 00:00:00 | 女   |</span><br><span class="line">| 07   | 郑竹   | 1989-01-01 00:00:00 | 女   |</span><br><span class="line">| 09   | 张三   | 2017-12-20 00:00:00 | 女   |</span><br><span class="line">| 10   | 李四   | 2017-12-25 00:00:00 | 女   |</span><br><span class="line">| 11   | 李四   | 2012-06-06 00:00:00 | 女   |</span><br><span class="line">| 12   | 赵六   | 2013-06-13 00:00:00 | 女   |</span><br><span class="line">| 13   | 孙七   | 2014-06-01 00:00:00 | 女   |</span><br><span class="line">+------+--------+---------------------+------+</span><br></pre></td></tr></table></figure>

<h3 id="15-查询学过编号为”01”但是没有学过编号为”02”的课程的同学的信息"><a href="#15-查询学过编号为”01”但是没有学过编号为”02”的课程的同学的信息" class="headerlink" title="15. 查询学过编号为”01”但是没有学过编号为”02”的课程的同学的信息"></a>15. 查询学过编号为”01”但是没有学过编号为”02”的课程的同学的信息</h3><p>解题思路：把学生表和成绩表连接，找出学过课程Id为01的这些学生，然后在这些学生中，去除学过课程id为02 的学生。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> st.*, sc.CId, sc.score</span><br><span class="line"><span class="keyword">FROM</span> Score <span class="keyword">AS</span> sc <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Student <span class="keyword">AS</span> st</span><br><span class="line"><span class="keyword">ON</span> sc.SId = st.SId</span><br><span class="line"><span class="keyword">WHERE</span> CId = <span class="string">'01'</span></span><br><span class="line"><span class="keyword">AND</span> sc.SId <span class="keyword">NOT</span> <span class="keyword">IN</span> </span><br><span class="line">(</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">SId</span></span><br><span class="line">    <span class="keyword">FROM</span> Score</span><br><span class="line">    <span class="keyword">WHERE</span> CId = <span class="string">'02'</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+------+-------+</span><br><span class="line">| SId  | Sname  | Sage                | Ssex | CId  | score |</span><br><span class="line">+------+--------+---------------------+------+------+-------+</span><br><span class="line">| 06   | 吴兰   | 1992-01-01 00:00:00 | 女   | 01   |  31.0 |</span><br><span class="line">+------+--------+---------------------+------+------+-------+</span><br></pre></td></tr></table></figure>

<h3 id="16-查询至少有一门课与学号为”01”的同学所学相同的同学的信息"><a href="#16-查询至少有一门课与学号为”01”的同学所学相同的同学的信息" class="headerlink" title="16.查询至少有一门课与学号为”01”的同学所学相同的同学的信息"></a>16.查询至少有一门课与学号为”01”的同学所学相同的同学的信息</h3><p>解题思路：把学生表和成绩表连接，找出(成绩表中课程) IN (学号01的学生学习的所有课程)，注意把01学生自己排除掉。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> st.*</span><br><span class="line"><span class="keyword">FROM</span> Student <span class="keyword">AS</span> st <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Score <span class="keyword">AS</span> sc</span><br><span class="line"><span class="keyword">ON</span> st.SId = sc.SId</span><br><span class="line"><span class="keyword">WHERE</span> sc.CId <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> CId</span><br><span class="line">    <span class="keyword">FROM</span> Score</span><br><span class="line">    <span class="keyword">WHERE</span> <span class="keyword">SId</span> = <span class="string">'01'</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">AND</span> sc.SId != <span class="string">'01'</span>;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+</span><br><span class="line">| SId  | Sname  | Sage                | Ssex |</span><br><span class="line">+------+--------+---------------------+------+</span><br><span class="line">| 02   | 钱电   | 1990-12-21 00:00:00 | 男   |</span><br><span class="line">| 03   | 孙风   | 1990-12-20 00:00:00 | 男   |</span><br><span class="line">| 04   | 李云   | 1990-12-06 00:00:00 | 男   |</span><br><span class="line">| 05   | 周梅   | 1991-12-01 00:00:00 | 女   |</span><br><span class="line">| 06   | 吴兰   | 1992-01-01 00:00:00 | 女   |</span><br><span class="line">| 07   | 郑竹   | 1989-01-01 00:00:00 | 女   |</span><br><span class="line">+------+--------+---------------------+------+</span><br></pre></td></tr></table></figure>

<h3 id="17-查询和学号为”01”的同学学习的课程完全相同的其他同学的信息"><a href="#17-查询和学号为”01”的同学学习的课程完全相同的其他同学的信息" class="headerlink" title="17. 查询和学号为”01”的同学学习的课程完全相同的其他同学的信息"></a>17. 查询和学号为”01”的同学学习的课程完全相同的其他同学的信息</h3><p>解题思路：完全相同有两个条件，一个是课程id相同，一个是课程数量相同。<br>先查找学号01学习了哪些课程(比如学了1 2 3)，<br>然后找这样的学生：他们学习的课程和学号01学习的课程有相同的(比如学号02学了1 2 3，学号03学了1 3， 学号04学了1)，注意把学号01自身过滤掉<br>最后，有相同的课程，但是课程数量可能不一样，因此还需要以课程数量相同作为进一步的筛选条件，得出数量相同并且课程编号相同的学生。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> st.SId, st.Sname</span><br><span class="line"><span class="keyword">FROM</span> Student <span class="keyword">AS</span> st <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Score <span class="keyword">AS</span> sc</span><br><span class="line"><span class="keyword">ON</span> st.SId = sc.SId</span><br><span class="line"><span class="keyword">WHERE</span> sc.CId <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> CId</span><br><span class="line">    <span class="keyword">FROM</span> Score</span><br><span class="line">    <span class="keyword">WHERE</span> <span class="keyword">SId</span> = <span class="string">'01'</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">AND</span> sc.SId != <span class="string">'01'</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> st.SId, st.Sname</span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(<span class="keyword">DISTINCT</span> sc.CId) = (<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(<span class="keyword">DISTINCT</span> CId) <span class="keyword">FROM</span> Score <span class="keyword">WHERE</span> <span class="keyword">SId</span> = <span class="string">'01'</span>);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+</span><br><span class="line">| SId  | Sname  |</span><br><span class="line">+------+--------+</span><br><span class="line">| 02   | 钱电   |</span><br><span class="line">| 03   | 孙风   |</span><br><span class="line">| 04   | 李云   |</span><br><span class="line">+------+--------+</span><br></pre></td></tr></table></figure>
<h3 id="18-查询课程编号为“02”的总成绩"><a href="#18-查询课程编号为“02”的总成绩" class="headerlink" title="18. 查询课程编号为“02”的总成绩"></a>18. 查询课程编号为“02”的总成绩</h3><p>解题思路：使用SUM函数</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">SUM</span>(score) <span class="keyword">AS</span> <span class="string">'02课程总成绩'</span></span><br><span class="line"><span class="keyword">FROM</span> Score</span><br><span class="line"><span class="keyword">WHERE</span> CId = <span class="string">'02'</span>;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+-------------------+</span><br><span class="line">| 02课程总成绩      |</span><br><span class="line">+-------------------+</span><br><span class="line">|             436.0 |</span><br><span class="line">+-------------------+</span><br></pre></td></tr></table></figure>

<h3 id="19-检索”-01-“课程分数小于-60，按分数降序排列的学生信息"><a href="#19-检索”-01-“课程分数小于-60，按分数降序排列的学生信息" class="headerlink" title="19. 检索” 01 “课程分数小于 60，按分数降序排列的学生信息"></a>19. 检索” 01 “课程分数小于 60，按分数降序排列的学生信息</h3><p>解题思路：</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> st.*, sc.score <span class="keyword">AS</span> <span class="string">'01课程分数'</span></span><br><span class="line"><span class="keyword">FROM</span> Student <span class="keyword">AS</span> st <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Score <span class="keyword">AS</span> sc</span><br><span class="line"><span class="keyword">ON</span> st.SId = sc.SId</span><br><span class="line"><span class="keyword">WHERE</span> sc.CId = <span class="string">'01'</span> <span class="keyword">AND</span> sc.score &lt; <span class="number">60</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> sc.score <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+----------------+</span><br><span class="line">| SId  | Sname  | Sage                | Ssex | 01课程分数     |</span><br><span class="line">+------+--------+---------------------+------+----------------+</span><br><span class="line">| 04   | 李云   | 1990-12-06 00:00:00 | 男   |           50.0 |</span><br><span class="line">| 06   | 吴兰   | 1992-01-01 00:00:00 | 女   |           31.0 |</span><br><span class="line">+------+--------+---------------------+------+----------------+</span><br></pre></td></tr></table></figure>
<h3 id="20-查询两门及其以上不及格课程的同学的学号，姓名及其平均成绩"><a href="#20-查询两门及其以上不及格课程的同学的学号，姓名及其平均成绩" class="headerlink" title="20. 查询两门及其以上不及格课程的同学的学号，姓名及其平均成绩"></a>20. 查询两门及其以上不及格课程的同学的学号，姓名及其平均成绩</h3><p>解题思路：先在分数表中找出所有不及格的学生，然后在其中把学生分组，找出每个学生不及格的数量，选择不及格课程数量&gt;=2的学生。<br>然后把学生表和分数表连接，对学生分组，找出学生id是上一步中不及格&gt;=2的学生id。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> st.SId, st.Sname, <span class="keyword">AVG</span>(sc.score) <span class="keyword">AS</span> avg_score</span><br><span class="line"><span class="keyword">FROM</span> Score <span class="keyword">AS</span> sc <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Student <span class="keyword">AS</span> st</span><br><span class="line"><span class="keyword">ON</span> sc.SId = st.SId</span><br><span class="line"><span class="keyword">WHERE</span> st.SId <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">SId</span></span><br><span class="line">    <span class="keyword">FROM</span> Score</span><br><span class="line">    <span class="keyword">WHERE</span> score &lt; <span class="number">60</span></span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">SId</span></span><br><span class="line">    <span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(CId) &gt;= <span class="number">2</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> st.SId, st.Sname;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+-----------+</span><br><span class="line">| SId  | Sname  | avg_score |</span><br><span class="line">+------+--------+-----------+</span><br><span class="line">| 04   | 李云   |  33.33333 |</span><br><span class="line">| 06   | 吴兰   |  32.50000 |</span><br><span class="line">+------+--------+-----------+</span><br></pre></td></tr></table></figure>

<h3 id="21-按平均成绩从高到低显示所有学生的所有课程的成绩以及平均成绩"><a href="#21-按平均成绩从高到低显示所有学生的所有课程的成绩以及平均成绩" class="headerlink" title="21. 按平均成绩从高到低显示所有学生的所有课程的成绩以及平均成绩"></a>21. 按平均成绩从高到低显示所有学生的所有课程的成绩以及平均成绩</h3><p>解题思路：把每个学生的平均成绩找出来记为表t，和成绩表连接。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sc.*, t.avg_score</span><br><span class="line"><span class="keyword">FROM</span> Score <span class="keyword">as</span> sc </span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">SId</span>, <span class="keyword">AVG</span>(score) <span class="keyword">as</span> avg_score</span><br><span class="line">    <span class="keyword">FROM</span> Score</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">SId</span></span><br><span class="line">) <span class="keyword">as</span> t</span><br><span class="line"><span class="keyword">ON</span> sc.SId = t.SId</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> avg_score <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">+------+------+-------+-----------+</span><br><span class="line">| SId  | CId  | score | avg_score |</span><br><span class="line">+------+------+-------+-----------+</span><br><span class="line">| 07   | 03   |  98.0 |  93.50000 |</span><br><span class="line">| 07   | 02   |  89.0 |  93.50000 |</span><br><span class="line">| 01   | 01   |  80.0 |  89.66667 |</span><br><span class="line">| 01   | 02   |  90.0 |  89.66667 |</span><br><span class="line">| 01   | 03   |  99.0 |  89.66667 |</span><br><span class="line">| 05   | 01   |  76.0 |  81.50000 |</span><br><span class="line">| 05   | 02   |  87.0 |  81.50000 |</span><br><span class="line">| 03   | 03   |  80.0 |  80.00000 |</span><br><span class="line">| 03   | 01   |  80.0 |  80.00000 |</span><br><span class="line">| 03   | 02   |  80.0 |  80.00000 |</span><br><span class="line">| 02   | 01   |  70.0 |  70.00000 |</span><br><span class="line">| 02   | 02   |  60.0 |  70.00000 |</span><br><span class="line">| 02   | 03   |  80.0 |  70.00000 |</span><br><span class="line">| 04   | 01   |  50.0 |  33.33333 |</span><br><span class="line">| 04   | 02   |  30.0 |  33.33333 |</span><br><span class="line">| 04   | 03   |  20.0 |  33.33333 |</span><br><span class="line">| 06   | 03   |  34.0 |  32.50000 |</span><br><span class="line">| 06   | 01   |  31.0 |  32.50000 |</span><br><span class="line">+------+------+-------+-----------+</span><br></pre></td></tr></table></figure>

<h3 id="22-查询各科成绩最高分、最低分和平均分"><a href="#22-查询各科成绩最高分、最低分和平均分" class="headerlink" title="22. 查询各科成绩最高分、最低分和平均分"></a>22. 查询各科成绩最高分、最低分和平均分</h3><p>以如下形式显示：课程 ID，课程 name，最高分，最低分，平均分，及格率，中等率，优良率，优秀率<br>及格为&gt;=60，中等为：70-80，优良为：80-90，优秀为：&gt;=90<br>要求输出课程号和选修人数，查询结果按人数降序排列，若人数相同，按课程号升序排列</p>
<p>解题思路：需要按各科成绩统计，因此首先把课程分组，然后使用COUNT, MAX, MIN, AVG函数计算对应值</p>
<p>及格率的计算公式：这门课及格的人数/选这门课的总人数，其中及格为score&gt;=60</p>
<p>中等率的计算公式：这门课中等的人数/选这门课的总人数，其中中等为s.score &gt;= 70 AND s.score &lt;80</p>
<p>计算过程：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SUM(IF(s.score &gt;= 60, 1, 0))   -- 得出及格数</span><br><span class="line"></span><br><span class="line">SUM(IF(s.score &gt;= 60, 1, 0)) / COUNT(s.SId)   -- 得出及格率</span><br><span class="line"></span><br><span class="line">ROUND((SUM(IF(s.score &gt;= 60, 1, 0)) / COUNT(s.SId)) * 100, 2)  --把及格率转换为百分比形式，如0.6667，转为66.67</span><br><span class="line"></span><br><span class="line">CONCAT(ROUND((SUM(IF(s.score &gt;= 60, 1, 0)) / COUNT(s.SId)) * 100, 2), '%') AS '及格率'    --用concat加上'%'号</span><br></pre></td></tr></table></figure>

<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    c.CId <span class="keyword">AS</span> <span class="string">'课程ID'</span>,</span><br><span class="line">    c.Cname <span class="keyword">AS</span> <span class="string">'课程名称'</span>,</span><br><span class="line">    <span class="keyword">COUNT</span>(s.SId) <span class="keyword">AS</span> <span class="string">'选修人数'</span>,</span><br><span class="line">    <span class="keyword">MAX</span>(s.score) <span class="keyword">AS</span> <span class="string">'最高分'</span>,</span><br><span class="line">    <span class="keyword">MIN</span>(s.score) <span class="keyword">AS</span> <span class="string">'最低分'</span>,</span><br><span class="line">    <span class="keyword">ROUND</span>(<span class="keyword">AVG</span>(s.score), <span class="number">2</span>) <span class="keyword">AS</span> <span class="string">'平均分'</span>,</span><br><span class="line">    <span class="keyword">CONCAT</span>(<span class="keyword">ROUND</span>((<span class="keyword">SUM</span>(<span class="keyword">IF</span>(s.score &gt;= <span class="number">60</span>, <span class="number">1</span>, <span class="number">0</span>)) / <span class="keyword">COUNT</span>(s.SId)) * <span class="number">100</span>, <span class="number">2</span>), <span class="string">'%'</span>) <span class="keyword">AS</span> <span class="string">'及格率'</span>,</span><br><span class="line">    <span class="keyword">CONCAT</span>(<span class="keyword">ROUND</span>((<span class="keyword">SUM</span>(<span class="keyword">IF</span>(s.score &gt;= <span class="number">70</span> <span class="keyword">AND</span> s.score &lt;<span class="number">80</span>, <span class="number">1</span>, <span class="number">0</span>)) / <span class="keyword">COUNT</span>(s.SId)) * <span class="number">100</span>, <span class="number">2</span>), <span class="string">'%'</span>) <span class="keyword">AS</span> <span class="string">'中等率'</span>,</span><br><span class="line">    <span class="keyword">CONCAT</span>(<span class="keyword">ROUND</span>((<span class="keyword">SUM</span>(<span class="keyword">IF</span>(s.score &gt;= <span class="number">80</span> <span class="keyword">AND</span> s.score &lt;<span class="number">90</span>, <span class="number">1</span>, <span class="number">0</span>)) / <span class="keyword">COUNT</span>(s.SId)) * <span class="number">100</span>, <span class="number">2</span>), <span class="string">'%'</span>) <span class="keyword">AS</span> <span class="string">'优良率'</span>,</span><br><span class="line">    <span class="keyword">CONCAT</span>(<span class="keyword">ROUND</span>((<span class="keyword">SUM</span>(<span class="keyword">IF</span>(s.score &gt;= <span class="number">90</span> <span class="keyword">AND</span> s.score &lt;=<span class="number">100</span>, <span class="number">1</span>, <span class="number">0</span>)) / <span class="keyword">COUNT</span>(s.SId)) * <span class="number">100</span>, <span class="number">2</span>), <span class="string">'%'</span>) <span class="keyword">AS</span> <span class="string">'优秀率'</span></span><br><span class="line"><span class="keyword">FROM</span> Score <span class="keyword">AS</span> s <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Course <span class="keyword">AS</span> c</span><br><span class="line"><span class="keyword">ON</span> s.CId = c.CId</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> c.CId, c.Cname</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="string">'选修人数'</span> <span class="keyword">DESC</span>, c.CId;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+----------+--------------+--------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+</span><br><span class="line">| 课程ID    | 课程名称     | 选修人数       | 最高分     | 最低分     | 平均分     | 及格率     | 中等率     | 优良率     | 优秀率    |</span><br><span class="line">+----------+--------------+--------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+</span><br><span class="line">| 01       | 语文         |            6 |      80.0 |      31.0 |     64.50 | 66.67%    | 33.33%    | 33.33%    | 0.00%     |</span><br><span class="line">| 02       | 数学         |            6 |      90.0 |      30.0 |     72.67 | 83.33%    | 0.00%     | 50.00%    | 16.67%    |</span><br><span class="line">| 03       | 英语         |            6 |      99.0 |      20.0 |     68.50 | 66.67%    | 0.00%     | 33.33%    | 33.33%    |</span><br><span class="line">+----------+--------------+--------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+</span><br></pre></td></tr></table></figure>

<h3 id="23-按各科成绩进行排序，并显示排名，总分重复时保留名次空缺"><a href="#23-按各科成绩进行排序，并显示排名，总分重复时保留名次空缺" class="headerlink" title="23. 按各科成绩进行排序，并显示排名，总分重复时保留名次空缺"></a>23. 按各科成绩进行排序，并显示排名，总分重复时保留名次空缺</h3><p>解题思路：按学科类别显示排名， 使用窗口函数，partition by 课程类别， order by 分数 逆序排列。<br>总分相同时保留空缺，即1,2,2,4,5这样，使用rank()函数</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *, <span class="keyword">RANK</span>() <span class="keyword">OVER</span> (<span class="keyword">partition</span> <span class="keyword">by</span> CId <span class="keyword">ORDER</span> <span class="keyword">BY</span> score <span class="keyword">DESC</span>) <span class="keyword">AS</span> <span class="string">'排名'</span></span><br><span class="line"><span class="keyword">FROM</span> Score</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> CId, 排名;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">+------+------+-------+--------+</span><br><span class="line">| SId  | CId  | score | 排名   |</span><br><span class="line">+------+------+-------+--------+</span><br><span class="line">| 01   | 01   |  80.0 |      1 |</span><br><span class="line">| 03   | 01   |  80.0 |      1 |</span><br><span class="line">| 05   | 01   |  76.0 |      3 |</span><br><span class="line">| 02   | 01   |  70.0 |      4 |</span><br><span class="line">| 04   | 01   |  50.0 |      5 |</span><br><span class="line">| 06   | 01   |  31.0 |      6 |</span><br><span class="line">| 01   | 02   |  90.0 |      1 |</span><br><span class="line">| 07   | 02   |  89.0 |      2 |</span><br><span class="line">| 05   | 02   |  87.0 |      3 |</span><br><span class="line">| 03   | 02   |  80.0 |      4 |</span><br><span class="line">| 02   | 02   |  60.0 |      5 |</span><br><span class="line">| 04   | 02   |  30.0 |      6 |</span><br><span class="line">| 01   | 03   |  99.0 |      1 |</span><br><span class="line">| 07   | 03   |  98.0 |      2 |</span><br><span class="line">| 02   | 03   |  80.0 |      3 |</span><br><span class="line">| 03   | 03   |  80.0 |      3 |</span><br><span class="line">| 06   | 03   |  34.0 |      5 |</span><br><span class="line">| 04   | 03   |  20.0 |      6 |</span><br><span class="line">+------+------+-------+--------+</span><br></pre></td></tr></table></figure>

<h3 id="24-按各科成绩进行排序，并显示排名，-总分重复时合并名次"><a href="#24-按各科成绩进行排序，并显示排名，-总分重复时合并名次" class="headerlink" title="24. 按各科成绩进行排序，并显示排名， 总分重复时合并名次"></a>24. 按各科成绩进行排序，并显示排名， 总分重复时合并名次</h3><p>解题思路：与23题大体相同，不同的是总分重复时合并名次，即1,2,2,3,4,5这样，选择dense_rank()函数。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *, <span class="keyword">DENSE_RANK</span>() <span class="keyword">OVER</span> (<span class="keyword">partition</span> <span class="keyword">by</span> CId <span class="keyword">ORDER</span> <span class="keyword">BY</span> score <span class="keyword">DESC</span>) <span class="keyword">AS</span> <span class="string">'排名'</span></span><br><span class="line"><span class="keyword">FROM</span> Score</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> CId, 排名;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">+------+------+-------+--------+</span><br><span class="line">| SId  | CId  | score | 排名   |</span><br><span class="line">+------+------+-------+--------+</span><br><span class="line">| 01   | 01   |  80.0 |      1 |</span><br><span class="line">| 03   | 01   |  80.0 |      1 |</span><br><span class="line">| 05   | 01   |  76.0 |      2 |</span><br><span class="line">| 02   | 01   |  70.0 |      3 |</span><br><span class="line">| 04   | 01   |  50.0 |      4 |</span><br><span class="line">| 06   | 01   |  31.0 |      5 |</span><br><span class="line">| 01   | 02   |  90.0 |      1 |</span><br><span class="line">| 07   | 02   |  89.0 |      2 |</span><br><span class="line">| 05   | 02   |  87.0 |      3 |</span><br><span class="line">| 03   | 02   |  80.0 |      4 |</span><br><span class="line">| 02   | 02   |  60.0 |      5 |</span><br><span class="line">| 04   | 02   |  30.0 |      6 |</span><br><span class="line">| 01   | 03   |  99.0 |      1 |</span><br><span class="line">| 07   | 03   |  98.0 |      2 |</span><br><span class="line">| 02   | 03   |  80.0 |      3 |</span><br><span class="line">| 03   | 03   |  80.0 |      3 |</span><br><span class="line">| 06   | 03   |  34.0 |      4 |</span><br><span class="line">| 04   | 03   |  20.0 |      5 |</span><br><span class="line">+------+------+-------+--------+</span><br></pre></td></tr></table></figure>

<h3 id="25-查询学生的总成绩，并进行排名，总分重复时保留名次空缺"><a href="#25-查询学生的总成绩，并进行排名，总分重复时保留名次空缺" class="headerlink" title="25. 查询学生的总成绩，并进行排名，总分重复时保留名次空缺"></a>25. 查询学生的总成绩，并进行排名，总分重复时保留名次空缺</h3><p>解题思路：先把学生分组，计算每个学生的总成绩，然后对分数进行排名，使用rank()窗口函数。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    <span class="keyword">SId</span>,</span><br><span class="line">    <span class="keyword">SUM</span>(score) <span class="keyword">AS</span> <span class="string">'总成绩'</span>,</span><br><span class="line">    <span class="keyword">rank</span>() <span class="keyword">OVER</span> (<span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">SUM</span>(score) <span class="keyword">DESC</span>) <span class="keyword">AS</span> <span class="string">'排名'</span></span><br><span class="line"><span class="keyword">FROM</span> Score</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">SId</span>;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">+------+-----------+--------+</span><br><span class="line">| SId  | 总成绩    | 排名   |</span><br><span class="line">+------+-----------+--------+</span><br><span class="line">| 01   |     269.0 |      1 |</span><br><span class="line">| 03   |     240.0 |      2 |</span><br><span class="line">| 02   |     210.0 |      3 |</span><br><span class="line">| 07   |     187.0 |      4 |</span><br><span class="line">| 05   |     163.0 |      5 |</span><br><span class="line">| 04   |     100.0 |      6 |</span><br><span class="line">| 06   |      65.0 |      7 |</span><br><span class="line">+------+-----------+--------+</span><br></pre></td></tr></table></figure>
<h3 id="26-查询学生的平均成绩，并进行排名"><a href="#26-查询学生的平均成绩，并进行排名" class="headerlink" title="26. 查询学生的平均成绩，并进行排名"></a>26. 查询学生的平均成绩，并进行排名</h3><p>解题思路：和26题类似。函数换成AVG()</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    <span class="keyword">SId</span>,</span><br><span class="line">    <span class="keyword">AVG</span>(score) <span class="keyword">AS</span> <span class="string">'平均成绩'</span>,</span><br><span class="line">    <span class="keyword">rank</span>() <span class="keyword">OVER</span> (<span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">AVG</span>(score) <span class="keyword">DESC</span>) <span class="keyword">AS</span> <span class="string">'排名'</span></span><br><span class="line"><span class="keyword">FROM</span> Score</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">SId</span>;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">+------+--------------+--------+</span><br><span class="line">| SId  | 平均成绩      | 排名    |</span><br><span class="line">+------+--------------+--------+</span><br><span class="line">| 07   |     93.50000 |      1 |</span><br><span class="line">| 01   |     89.66667 |      2 |</span><br><span class="line">| 05   |     81.50000 |      3 |</span><br><span class="line">| 03   |     80.00000 |      4 |</span><br><span class="line">| 02   |     70.00000 |      5 |</span><br><span class="line">| 04   |     33.33333 |      6 |</span><br><span class="line">| 06   |     32.50000 |      7 |</span><br><span class="line">+------+--------------+--------+</span><br></pre></td></tr></table></figure>

<h3 id="27-统计各科成绩各分数段的人数：课程编号，课程名称，-100-85-85-70-70-60-60-0-及所占百分比"><a href="#27-统计各科成绩各分数段的人数：课程编号，课程名称，-100-85-85-70-70-60-60-0-及所占百分比" class="headerlink" title="27. 统计各科成绩各分数段的人数：课程编号，课程名称，[100-85],[85-70],[70-60],[60-0]及所占百分比"></a>27. 统计各科成绩各分数段的人数：课程编号，课程名称，[100-85],[85-70],[70-60],[60-0]及所占百分比</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SUM(IF(s.score &gt;= 60, 1, 0))   -- 得出及格数</span><br><span class="line"></span><br><span class="line">SUM(IF(s.score &gt;= 60, 1, 0)) / COUNT(s.SId)   -- 得出及格率</span><br><span class="line"></span><br><span class="line">ROUND((SUM(IF(s.score &gt;= 60, 1, 0)) / COUNT(s.SId)) * 100, 2)  --把及格率转换为百分比形式，如0.6667，转为66.67</span><br><span class="line"></span><br><span class="line">CONCAT(ROUND((SUM(IF(s.score &gt;= 60, 1, 0)) / COUNT(s.SId)) * 100, 2), '%') AS '及格率'    --用concat加上'%'号</span><br></pre></td></tr></table></figure>

<p>解题思路：</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    c.CId,</span><br><span class="line">    c.Cname,</span><br><span class="line">    <span class="keyword">CONCAT</span>(<span class="keyword">ROUND</span>((<span class="keyword">SUM</span>(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> s.score&gt;=<span class="number">85</span> <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) / <span class="keyword">COUNT</span>(s.SId)) * <span class="number">100</span>, <span class="number">2</span>), <span class="string">'%'</span>) <span class="keyword">AS</span> <span class="string">'[100-85]分数段占比'</span>,</span><br><span class="line">    <span class="keyword">CONCAT</span>(<span class="keyword">ROUND</span>((<span class="keyword">SUM</span>(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> s.score&gt;=<span class="number">70</span> <span class="keyword">AND</span> s.score &lt; <span class="number">85</span> <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) / <span class="keyword">COUNT</span>(s.SId)) * <span class="number">100</span>, <span class="number">2</span>), <span class="string">'%'</span>) <span class="keyword">AS</span> <span class="string">'[85-70]分数段占比'</span>,</span><br><span class="line">    <span class="keyword">CONCAT</span>(<span class="keyword">ROUND</span>((<span class="keyword">SUM</span>(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> s.score&gt;=<span class="number">60</span> <span class="keyword">AND</span> s.score &lt; <span class="number">70</span> <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) / <span class="keyword">COUNT</span>(s.SId)) * <span class="number">100</span>, <span class="number">2</span>), <span class="string">'%'</span>) <span class="keyword">AS</span> <span class="string">'[70-60]分数段占比'</span>,</span><br><span class="line">    <span class="keyword">CONCAT</span>(<span class="keyword">ROUND</span>((<span class="keyword">SUM</span>(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> s.score&gt;=<span class="number">0</span> <span class="keyword">AND</span> s.score &lt; <span class="number">60</span> <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) / <span class="keyword">COUNT</span>(s.SId)) * <span class="number">100</span>, <span class="number">2</span>), <span class="string">'%'</span>) <span class="keyword">AS</span> <span class="string">'[60-0]分数段占比'</span></span><br><span class="line"><span class="keyword">FROM</span> Score <span class="keyword">AS</span> s <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Course <span class="keyword">AS</span> c</span><br><span class="line"><span class="keyword">ON</span> s.CId = c.CId</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> c.CId, c.Cname;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+-------------------------+------------------------+------------------------+-----------------------+</span><br><span class="line">| CId  | Cname  | [100-85]分数段占比       | [85-70]分数段占比        | [70-60]分数段占比       | [60-0]分数段占比        |</span><br><span class="line">+------+--------+-------------------------+------------------------+------------------------+-----------------------+</span><br><span class="line">| 01   | 语文   | 0.00%                   | 66.67%                 | 0.00%                  | 33.33%                |</span><br><span class="line">| 02   | 数学   | 50.00%                  | 16.67%                 | 16.67%                 | 16.67%                |</span><br><span class="line">| 03   | 英语   | 33.33%                  | 33.33%                 | 0.00%                  | 33.33%                |</span><br><span class="line">+------+--------+-------------------------+------------------------+------------------------+-----------------------+</span><br></pre></td></tr></table></figure>

<h3 id="28-查询各科成绩前三名的记录"><a href="#28-查询各科成绩前三名的记录" class="headerlink" title="28. 查询各科成绩前三名的记录"></a>28. 查询各科成绩前三名的记录</h3><p>解题思路：首先按学科分组，对每个学科的分数进行排名，得到一个排名列(类似于23题)。然后把这个排名列放在分数表右边。最后过滤出排名为1,2,3的，再用order排序。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s.SId, s.CId, s.score, t.rank</span><br><span class="line"><span class="keyword">FROM</span> Score <span class="keyword">as</span> s <span class="keyword">INNER</span> <span class="keyword">JOIN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">SId</span>, CId, row_number() <span class="keyword">OVER</span> (<span class="keyword">partition</span> <span class="keyword">by</span> CId <span class="keyword">ORDER</span> <span class="keyword">BY</span> score <span class="keyword">DESC</span>) <span class="keyword">AS</span> <span class="string">'rank'</span></span><br><span class="line">    <span class="keyword">FROM</span> Score</span><br><span class="line">) <span class="keyword">as</span> t</span><br><span class="line"><span class="keyword">ON</span> s.SId = t.SId</span><br><span class="line"><span class="keyword">AND</span> s.CId = t.CId</span><br><span class="line"><span class="keyword">WHERE</span> t.rank = <span class="number">1</span> <span class="keyword">or</span> t.rank = <span class="number">2</span> <span class="keyword">or</span> t.rank = <span class="number">3</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> s.CId, t.rank;</span><br></pre></td></tr></table></figure>

<p>第二种方法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">SId</span>, CId, score, </span><br><span class="line">        row_number() <span class="keyword">OVER</span> (<span class="keyword">partition</span> <span class="keyword">by</span> CId <span class="keyword">order</span> <span class="keyword">by</span> score <span class="keyword">DESC</span>) <span class="keyword">AS</span> <span class="string">'rank'</span></span><br><span class="line">    <span class="keyword">FROM</span> Score </span><br><span class="line">) <span class="keyword">as</span> t</span><br><span class="line"><span class="keyword">WHERE</span> t.rank <span class="keyword">IN</span> (<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">+------+------+-------+------+</span><br><span class="line">| SId  | CId  | score | rank |</span><br><span class="line">+------+------+-------+------+</span><br><span class="line">| 01   | 01   |  80.0 |    1 |</span><br><span class="line">| 03   | 01   |  80.0 |    2 |</span><br><span class="line">| 05   | 01   |  76.0 |    3 |</span><br><span class="line">| 01   | 02   |  90.0 |    1 |</span><br><span class="line">| 07   | 02   |  89.0 |    2 |</span><br><span class="line">| 05   | 02   |  87.0 |    3 |</span><br><span class="line">| 01   | 03   |  99.0 |    1 |</span><br><span class="line">| 07   | 03   |  98.0 |    2 |</span><br><span class="line">| 02   | 03   |  80.0 |    3 |</span><br><span class="line">+------+------+-------+------+</span><br></pre></td></tr></table></figure>

<p>如果不是前3名，而是前3000名，那么上面两种方法就不适用了。因此考虑第三种方法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> a.SId, a.CId, a.score</span><br><span class="line"><span class="keyword">FROM</span> Score <span class="keyword">AS</span> a</span><br><span class="line"><span class="keyword">WHERE</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">FROM</span> Score <span class="keyword">AS</span> b</span><br><span class="line">    <span class="keyword">WHERE</span> b.CId = a.CId</span><br><span class="line">    <span class="keyword">AND</span> b.score &gt; a.score</span><br><span class="line">) &lt; <span class="number">3</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> a.CId, a.score <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">+------+------+-------+</span><br><span class="line">| SId  | CId  | score |</span><br><span class="line">+------+------+-------+</span><br><span class="line">| 01   | 01   |  80.0 |</span><br><span class="line">| 03   | 01   |  80.0 |</span><br><span class="line">| 05   | 01   |  76.0 |</span><br><span class="line">| 01   | 02   |  90.0 |</span><br><span class="line">| 07   | 02   |  89.0 |</span><br><span class="line">| 05   | 02   |  87.0 |</span><br><span class="line">| 01   | 03   |  99.0 |</span><br><span class="line">| 07   | 03   |  98.0 |</span><br><span class="line">| 02   | 03   |  80.0 |</span><br><span class="line">| 03   | 03   |  80.0 |</span><br><span class="line">+------+------+-------+</span><br></pre></td></tr></table></figure>
<p>这里的count(1)，1并不是表示第一个字段，而是表示一共有多少符合条件的行。</p>
<h3 id="29-查询所有课程的成绩第2名到第3名的学生信息及该课程成绩"><a href="#29-查询所有课程的成绩第2名到第3名的学生信息及该课程成绩" class="headerlink" title="29. 查询所有课程的成绩第2名到第3名的学生信息及该课程成绩"></a>29. 查询所有课程的成绩第2名到第3名的学生信息及该课程成绩</h3><p>解题思路：和29题一样，只不过需要多连接一个学生表查出学生信息。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> st.*, s.CId, s.score, t.rank</span><br><span class="line"><span class="keyword">FROM</span> Student <span class="keyword">as</span> st </span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> Score <span class="keyword">as</span> s </span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">SId</span>, CId, row_number() <span class="keyword">OVER</span> (<span class="keyword">partition</span> <span class="keyword">by</span> CId <span class="keyword">ORDER</span> <span class="keyword">BY</span> score <span class="keyword">DESC</span>) <span class="keyword">AS</span> <span class="string">'rank'</span></span><br><span class="line">    <span class="keyword">FROM</span> Score</span><br><span class="line">) <span class="keyword">as</span> t</span><br><span class="line"><span class="keyword">ON</span> st.SId = s.SId</span><br><span class="line"><span class="keyword">AND</span> s.SId = t.SId</span><br><span class="line"><span class="keyword">AND</span> s.CId = t.CId</span><br><span class="line"><span class="keyword">WHERE</span> t.rank = <span class="number">2</span> <span class="keyword">or</span> t.rank = <span class="number">3</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> s.CId, t.rank;</span><br></pre></td></tr></table></figure>

<p>第二种写法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * </span><br><span class="line"><span class="keyword">FROM</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> </span><br><span class="line">        st.*, </span><br><span class="line">        sc.CId, </span><br><span class="line">        sc.score, </span><br><span class="line">        row_number() <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">BY</span> sc.CId <span class="keyword">ORDER</span> <span class="keyword">BY</span> sc.score <span class="keyword">DESC</span>) <span class="keyword">AS</span> <span class="string">'rank'</span></span><br><span class="line">    <span class="keyword">FROM</span> Score <span class="keyword">AS</span> sc <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Student <span class="keyword">AS</span> st </span><br><span class="line">    <span class="keyword">ON</span> sc.SId = st.SId</span><br><span class="line">) <span class="keyword">as</span> t</span><br><span class="line"><span class="keyword">WHERE</span> t.rank <span class="keyword">IN</span> (<span class="number">2</span>,<span class="number">3</span>);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+------+-------+------+</span><br><span class="line">| SId  | Sname  | Sage                | Ssex | CId  | score | rank |</span><br><span class="line">+------+--------+---------------------+------+------+-------+------+</span><br><span class="line">| 03   | 孙风   | 1990-12-20 00:00:00 | 男   | 01   |  80.0 |    2 |</span><br><span class="line">| 05   | 周梅   | 1991-12-01 00:00:00 | 女   | 01   |  76.0 |    3 |</span><br><span class="line">| 07   | 郑竹   | 1989-01-01 00:00:00 | 女   | 02   |  89.0 |    2 |</span><br><span class="line">| 05   | 周梅   | 1991-12-01 00:00:00 | 女   | 02   |  87.0 |    3 |</span><br><span class="line">| 07   | 郑竹   | 1989-01-01 00:00:00 | 女   | 03   |  98.0 |    2 |</span><br><span class="line">| 02   | 钱电   | 1990-12-21 00:00:00 | 男   | 03   |  80.0 |    3 |</span><br><span class="line">+------+--------+---------------------+------+------+-------+------+</span><br></pre></td></tr></table></figure>
<h3 id="30-查询每门课选修的学生人数"><a href="#30-查询每门课选修的学生人数" class="headerlink" title="30. 查询每门课选修的学生人数"></a>30. 查询每门课选修的学生人数</h3><p>解题思路：对课程分组，用COUNT计算人数</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> CId, <span class="keyword">COUNT</span>(<span class="keyword">SId</span>) <span class="keyword">AS</span> <span class="string">'选修人数'</span></span><br><span class="line"><span class="keyword">FROM</span> Score</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> CId;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+------+--------------+</span><br><span class="line">| CId  | 选修人数     |</span><br><span class="line">+------+--------------+</span><br><span class="line">| 01   |            6 |</span><br><span class="line">| 02   |            6 |</span><br><span class="line">| 03   |            6 |</span><br><span class="line">+------+--------------+</span><br></pre></td></tr></table></figure>

<h3 id="31-查询出只修两门课程的学生学号和姓名"><a href="#31-查询出只修两门课程的学生学号和姓名" class="headerlink" title="31.查询出只修两门课程的学生学号和姓名"></a>31.查询出只修两门课程的学生学号和姓名</h3><p>解题思路：把学生表和成绩表连接，然后对学生分组，使用COUNT统计每个学生的课程数量，使用HAVING过滤出数量=2的。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> st.SId, st.Sname</span><br><span class="line"><span class="keyword">FROM</span> Score <span class="keyword">AS</span> sc <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Student <span class="keyword">AS</span> st</span><br><span class="line"><span class="keyword">ON</span> sc.SId = st.SId</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> st.SId, st.Sname</span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(sc.CId) = <span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+</span><br><span class="line">| SId  | Sname  |</span><br><span class="line">+------+--------+</span><br><span class="line">| 05   | 周梅   |</span><br><span class="line">| 06   | 吴兰   |</span><br><span class="line">| 07   | 郑竹   |</span><br><span class="line">+------+--------+</span><br></pre></td></tr></table></figure>

<h3 id="32-查询男生、女生人数"><a href="#32-查询男生、女生人数" class="headerlink" title="32.查询男生、女生人数"></a>32.查询男生、女生人数</h3><p>解题思路：对性别分组，使用COUNT计算人数。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Ssex <span class="keyword">AS</span> <span class="string">'性别'</span>, <span class="keyword">COUNT</span>(*) <span class="keyword">AS</span> <span class="string">'人数'</span></span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> Ssex;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+--------+--------+</span><br><span class="line">| 性别   | 人数   |</span><br><span class="line">+--------+--------+</span><br><span class="line">| 男     |      4 |</span><br><span class="line">| 女     |      8 |</span><br><span class="line">+--------+--------+</span><br></pre></td></tr></table></figure>
<h3 id="33-查询名字中含有「风」字的学生信息"><a href="#33-查询名字中含有「风」字的学生信息" class="headerlink" title="33. 查询名字中含有「风」字的学生信息"></a>33. 查询名字中含有「风」字的学生信息</h3><p>解题思路：使用LIKE关键字，使用%</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">WHERE</span> Sname <span class="keyword">LIKE</span> <span class="string">'%风%'</span>;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+</span><br><span class="line">| SId  | Sname  | Sage                | Ssex |</span><br><span class="line">+------+--------+---------------------+------+</span><br><span class="line">| 03   | 孙风   | 1990-12-20 00:00:00 | 男   |</span><br><span class="line">+------+--------+---------------------+------+</span><br></pre></td></tr></table></figure>

<h3 id="34-查询同名学生名单，并统计同名人数"><a href="#34-查询同名学生名单，并统计同名人数" class="headerlink" title="34. 查询同名学生名单，并统计同名人数"></a>34. 查询同名学生名单，并统计同名人数</h3><p>解题思路：对学生名字分组，使用COUNT统计人数。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Sname, <span class="keyword">COUNT</span>(<span class="keyword">SId</span>) <span class="keyword">AS</span> <span class="string">'同名人数'</span></span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> Sname</span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(<span class="keyword">SId</span>) &gt;= <span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+--------+--------------+</span><br><span class="line">| Sname  | 同名人数     |</span><br><span class="line">+--------+--------------+</span><br><span class="line">| 李四   |            2 |</span><br><span class="line">+--------+--------------+</span><br></pre></td></tr></table></figure>

<p><strong>扩展：</strong>求出同名同性的：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s1.Sname, s1.Ssex, <span class="keyword">COUNT</span>(*) <span class="keyword">AS</span> <span class="string">'同名同性人数'</span></span><br><span class="line"><span class="keyword">FROM</span> Student <span class="keyword">AS</span> s1 <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Student <span class="keyword">AS</span> s2</span><br><span class="line"><span class="keyword">ON</span> s1.SId != s2.SId <span class="keyword">AND</span> s1.Sname = s2.Sname <span class="keyword">AND</span> s1.Ssex = s2.Ssex</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> s1.Sname, s1.Ssex;</span><br></pre></td></tr></table></figure>
<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+--------+------+--------------------+</span><br><span class="line">| Sname  | Ssex | 同名同性人数       |</span><br><span class="line">+--------+------+--------------------+</span><br><span class="line">| 李四   | 女   |                  2 |</span><br><span class="line">+--------+------+--------------------+</span><br></pre></td></tr></table></figure>

<h3 id="35-查询-1990-年出生的学生名单"><a href="#35-查询-1990-年出生的学生名单" class="headerlink" title="35. 查询 1990 年出生的学生名单"></a>35. 查询 1990 年出生的学生名单</h3><p>解题思路：使用YEAR()函数求出日期中关于年份的。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">YEAR</span>(Sage) = <span class="string">'1990'</span>;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+</span><br><span class="line">| SId  | Sname  | Sage                | Ssex |</span><br><span class="line">+------+--------+---------------------+------+</span><br><span class="line">| 01   | 赵雷   | 1990-01-01 00:00:00 | 男   |</span><br><span class="line">| 02   | 钱电   | 1990-12-21 00:00:00 | 男   |</span><br><span class="line">| 03   | 孙风   | 1990-12-20 00:00:00 | 男   |</span><br><span class="line">| 04   | 李云   | 1990-12-06 00:00:00 | 男   |</span><br><span class="line">+------+--------+---------------------+------+</span><br></pre></td></tr></table></figure>

<h3 id="36-查询平均成绩大于等于-85-的所有学生的学号、姓名和平均成绩"><a href="#36-查询平均成绩大于等于-85-的所有学生的学号、姓名和平均成绩" class="headerlink" title="36. 查询平均成绩大于等于 85 的所有学生的学号、姓名和平均成绩"></a>36. 查询平均成绩大于等于 85 的所有学生的学号、姓名和平均成绩</h3><p>解题思路：把学生表和分数表连接，对学生分组，求出每个学生的平均成绩，使用HAVING过滤出&gt;=85的。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> st.SId, st.Sname, <span class="keyword">AVG</span>(sc.score) <span class="keyword">AS</span> <span class="string">'avg_score'</span></span><br><span class="line"><span class="keyword">FROM</span> Student <span class="keyword">AS</span> st <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Score <span class="keyword">AS</span> sc</span><br><span class="line"><span class="keyword">ON</span> st.SId = sc.SId</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> st.SId, st.Sname</span><br><span class="line"><span class="keyword">HAVING</span> avg_score &gt;= <span class="number">85</span>;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+-----------+</span><br><span class="line">| SId  | Sname  | avg_score |</span><br><span class="line">+------+--------+-----------+</span><br><span class="line">| 01   | 赵雷   |  89.66667 |</span><br><span class="line">| 07   | 郑竹   |  93.50000 |</span><br><span class="line">+------+--------+-----------+</span><br></pre></td></tr></table></figure>
<h3 id="37-查询课程名称为「数学」，且分数低于-60-的学生姓名和分数"><a href="#37-查询课程名称为「数学」，且分数低于-60-的学生姓名和分数" class="headerlink" title="37. 查询课程名称为「数学」，且分数低于 60 的学生姓名和分数"></a>37. 查询课程名称为「数学」，且分数低于 60 的学生姓名和分数</h3><p>解题思路：把学生表，分数表，课程表连接，使用WHERE过滤条件。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> st.Sname, sc.score</span><br><span class="line"><span class="keyword">FROM</span> Student <span class="keyword">AS</span> st <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Score <span class="keyword">AS</span> sc <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Course <span class="keyword">AS</span> co</span><br><span class="line"><span class="keyword">ON</span> st.SId = sc.SId</span><br><span class="line"><span class="keyword">AND</span> sc.CId = co.CId</span><br><span class="line"><span class="keyword">WHERE</span> co.Cname = <span class="string">'数学'</span> <span class="keyword">AND</span> sc.score &lt; <span class="number">60</span>;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+--------+-------+</span><br><span class="line">| Sname  | score |</span><br><span class="line">+--------+-------+</span><br><span class="line">| 李云   |  30.0 |</span><br><span class="line">+--------+-------+</span><br></pre></td></tr></table></figure>

<h3 id="38-查询所有学生的课程及分数情况（存在学生没成绩，没选课的情况）"><a href="#38-查询所有学生的课程及分数情况（存在学生没成绩，没选课的情况）" class="headerlink" title="38. 查询所有学生的课程及分数情况（存在学生没成绩，没选课的情况）"></a>38. 查询所有学生的课程及分数情况（存在学生没成绩，没选课的情况）</h3><p>解题思路：需要学生信息，分数信息和课程信息。所以先把三表连接，找出所有学生信息，</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> st.SId, st.Sname</span><br><span class="line"><span class="keyword">FROM</span> Student <span class="keyword">AS</span> st </span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Score <span class="keyword">AS</span> sc <span class="keyword">ON</span> st.SId = sc.SId</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Course <span class="keyword">AS</span> co <span class="keyword">ON</span> sc.CId = co.CId</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> st.SId, st.Sname;</span><br></pre></td></tr></table></figure>

<p>然后按课程统计各科分数及总成绩：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    st.SId, </span><br><span class="line">    st.Sname,</span><br><span class="line">    <span class="keyword">SUM</span>(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> co.Cname=<span class="string">'语文'</span> <span class="keyword">THEN</span> sc.score <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">AS</span> <span class="string">'语文成绩'</span>,</span><br><span class="line">    <span class="keyword">SUM</span>(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> co.Cname=<span class="string">'数学'</span> <span class="keyword">THEN</span> sc.score <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">AS</span> <span class="string">'数学成绩'</span>,</span><br><span class="line">    <span class="keyword">SUM</span>(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> co.Cname=<span class="string">'英语'</span> <span class="keyword">THEN</span> sc.score <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">AS</span> <span class="string">'英语成绩'</span>,</span><br><span class="line">    <span class="keyword">SUM</span>(sc.score)  <span class="keyword">AS</span> <span class="string">'总分'</span></span><br><span class="line"><span class="keyword">FROM</span> Student <span class="keyword">AS</span> st </span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Score <span class="keyword">AS</span> sc <span class="keyword">ON</span> st.SId = sc.SId</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Course <span class="keyword">AS</span> co <span class="keyword">ON</span> sc.CId = co.CId</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> st.SId, st.Sname;</span><br></pre></td></tr></table></figure>
<p>其中，每个学生的各科成绩只有一门，为了在学生分组中取出这门成绩使用SUM函数，而不是为了对该科成绩求和。<br>得到结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+--------------+--------------+--------------+--------+</span><br><span class="line">| SId  | Sname  | 语文成绩     | 数学成绩     | 英语成绩     | 总分   |</span><br><span class="line">+------+--------+--------------+--------------+--------------+--------+</span><br><span class="line">| 01   | 赵雷   |         80.0 |         90.0 |         99.0 |  269.0 |</span><br><span class="line">| 02   | 钱电   |         70.0 |         60.0 |         80.0 |  210.0 |</span><br><span class="line">| 03   | 孙风   |         80.0 |         80.0 |         80.0 |  240.0 |</span><br><span class="line">| 04   | 李云   |         50.0 |         30.0 |         20.0 |  100.0 |</span><br><span class="line">| 05   | 周梅   |         76.0 |         87.0 |          0.0 |  163.0 |</span><br><span class="line">| 06   | 吴兰   |         31.0 |          0.0 |         34.0 |   65.0 |</span><br><span class="line">| 07   | 郑竹   |          0.0 |         89.0 |         98.0 |  187.0 |</span><br><span class="line">| 09   | 张三   |          0.0 |          0.0 |          0.0 |   NULL |</span><br><span class="line">| 10   | 李四   |          0.0 |          0.0 |          0.0 |   NULL |</span><br><span class="line">| 11   | 李四   |          0.0 |          0.0 |          0.0 |   NULL |</span><br><span class="line">| 12   | 赵六   |          0.0 |          0.0 |          0.0 |   NULL |</span><br><span class="line">| 13   | 孙七   |          0.0 |          0.0 |          0.0 |   NULL |</span><br><span class="line">+------+--------+--------------+--------------+--------------+--------+</span><br></pre></td></tr></table></figure>
<p>接下来对数据处理，第一步，把总分中的NULL转换为0，需要用COALESCE()函数。第二步，去除小数点后的0，使用CAST函数，</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    st.SId, </span><br><span class="line">    st.Sname,</span><br><span class="line">    <span class="keyword">CAST</span>(<span class="keyword">SUM</span>(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> co.Cname=<span class="string">'语文'</span> <span class="keyword">THEN</span> sc.score <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">as</span> <span class="built_in">real</span>) <span class="keyword">AS</span> <span class="string">'语文成绩'</span>,</span><br><span class="line">    <span class="keyword">CAST</span>(<span class="keyword">SUM</span>(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> co.Cname=<span class="string">'数学'</span> <span class="keyword">THEN</span> sc.score <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">as</span> <span class="built_in">real</span>) <span class="keyword">AS</span> <span class="string">'数学成绩'</span>,</span><br><span class="line">    <span class="keyword">CAST</span>(<span class="keyword">SUM</span>(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> co.Cname=<span class="string">'英语'</span> <span class="keyword">THEN</span> sc.score <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">as</span> <span class="built_in">real</span>) <span class="keyword">AS</span> <span class="string">'英语成绩'</span>,</span><br><span class="line">    <span class="keyword">CAST</span>(<span class="keyword">COALESCE</span>(<span class="keyword">SUM</span>(sc.score), <span class="number">0</span>) <span class="keyword">as</span> <span class="built_in">real</span>) <span class="keyword">AS</span> <span class="string">'总分'</span></span><br><span class="line"><span class="keyword">FROM</span> Student <span class="keyword">AS</span> st </span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Score <span class="keyword">AS</span> sc <span class="keyword">ON</span> st.SId = sc.SId</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Course <span class="keyword">AS</span> co <span class="keyword">ON</span> sc.CId = co.CId</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> st.SId, st.Sname;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+--------------+--------------+--------------+--------+</span><br><span class="line">| SId  | Sname  | 语文成绩      | 数学成绩      | 英语成绩      | 总分    |</span><br><span class="line">+------+--------+--------------+--------------+--------------+--------+</span><br><span class="line">| 01   | 赵雷   |           80 |           90 |           99 |    269 |</span><br><span class="line">| 02   | 钱电   |           70 |           60 |           80 |    210 |</span><br><span class="line">| 03   | 孙风   |           80 |           80 |           80 |    240 |</span><br><span class="line">| 04   | 李云   |           50 |           30 |           20 |    100 |</span><br><span class="line">| 05   | 周梅   |           76 |           87 |            0 |    163 |</span><br><span class="line">| 06   | 吴兰   |           31 |            0 |           34 |     65 |</span><br><span class="line">| 07   | 郑竹   |            0 |           89 |           98 |    187 |</span><br><span class="line">| 09   | 张三   |            0 |            0 |            0 |      0 |</span><br><span class="line">| 10   | 李四   |            0 |            0 |            0 |      0 |</span><br><span class="line">| 11   | 李四   |            0 |            0 |            0 |      0 |</span><br><span class="line">| 12   | 赵六   |            0 |            0 |            0 |      0 |</span><br><span class="line">| 13   | 孙七   |            0 |            0 |            0 |      0 |</span><br><span class="line">+------+--------+--------------+--------------+--------------+--------+</span><br></pre></td></tr></table></figure>

<h3 id="39-查询不同老师所教不同课程平均分从高到低显示"><a href="#39-查询不同老师所教不同课程平均分从高到低显示" class="headerlink" title="39. 查询不同老师所教不同课程平均分从高到低显示"></a>39. 查询不同老师所教不同课程平均分从高到低显示</h3><p>解题思路：把课程表和分数表连接，对老师及所教课程分组，使用AVG()计算平均分，DESC逆序排列。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> co.TId, co.CId, <span class="keyword">AVG</span>(sc.score) <span class="keyword">AS</span> <span class="string">'avg_score'</span></span><br><span class="line"><span class="keyword">FROM</span> Course <span class="keyword">AS</span> co <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Score <span class="keyword">AS</span> sc</span><br><span class="line"><span class="keyword">ON</span> co.CId = sc.CId</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> co.TId, co.CId</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> avg_score <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+------+------+-----------+</span><br><span class="line">| TId  | CId  | avg_score |</span><br><span class="line">+------+------+-----------+</span><br><span class="line">| 01   | 02   |  72.66667 |</span><br><span class="line">| 03   | 03   |  68.50000 |</span><br><span class="line">| 02   | 01   |  64.50000 |</span><br><span class="line">+------+------+-----------+</span><br></pre></td></tr></table></figure>

<h3 id="40-查询任何一门课程成绩在-70-分以上的姓名、课程名称和分数"><a href="#40-查询任何一门课程成绩在-70-分以上的姓名、课程名称和分数" class="headerlink" title="40. 查询任何一门课程成绩在 70 分以上的姓名、课程名称和分数"></a>40. 查询任何一门课程成绩在 70 分以上的姓名、课程名称和分数</h3><p>解题思路：</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> st.Sname, co.Cname, sc.score</span><br><span class="line"><span class="keyword">FROM</span> Student <span class="keyword">AS</span> st </span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> Score <span class="keyword">AS</span> sc <span class="keyword">ON</span> st.SId = sc.SId</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> Course <span class="keyword">AS</span> co <span class="keyword">ON</span> sc.CId = co.CId</span><br><span class="line"><span class="keyword">WHERE</span> sc.score &gt; <span class="number">70</span>;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">+--------+--------+-------+</span><br><span class="line">| Sname  | Cname  | score |</span><br><span class="line">+--------+--------+-------+</span><br><span class="line">| 赵雷   | 语文   |  80.0 |</span><br><span class="line">| 赵雷   | 数学   |  90.0 |</span><br><span class="line">| 赵雷   | 英语   |  99.0 |</span><br><span class="line">| 钱电   | 英语   |  80.0 |</span><br><span class="line">| 孙风   | 语文   |  80.0 |</span><br><span class="line">| 孙风   | 数学   |  80.0 |</span><br><span class="line">| 孙风   | 英语   |  80.0 |</span><br><span class="line">| 周梅   | 语文   |  76.0 |</span><br><span class="line">| 周梅   | 数学   |  87.0 |</span><br><span class="line">| 郑竹   | 数学   |  89.0 |</span><br><span class="line">| 郑竹   | 英语   |  98.0 |</span><br><span class="line">+--------+--------+-------+</span><br></pre></td></tr></table></figure>

<h3 id="41-查询不及格的课程并按课程号从大到小排列"><a href="#41-查询不及格的课程并按课程号从大到小排列" class="headerlink" title="41. 查询不及格的课程并按课程号从大到小排列"></a>41. 查询不及格的课程并按课程号从大到小排列</h3><p>解题思路：使用WHERE过滤出不及格的课程，DESC从大到小排序。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sc.CId, co.Cname, sc.score</span><br><span class="line"><span class="keyword">FROM</span> Score <span class="keyword">AS</span> sc <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Course <span class="keyword">AS</span> co</span><br><span class="line"><span class="keyword">ON</span> sc.CId = co.CId</span><br><span class="line"><span class="keyword">WHERE</span> sc.score &lt; <span class="number">60</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> sc.CId <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+-------+</span><br><span class="line">| CId  | Cname  | score |</span><br><span class="line">+------+--------+-------+</span><br><span class="line">| 03   | 英语   |  20.0 |</span><br><span class="line">| 03   | 英语   |  34.0 |</span><br><span class="line">| 02   | 数学   |  30.0 |</span><br><span class="line">| 01   | 语文   |  50.0 |</span><br><span class="line">| 01   | 语文   |  31.0 |</span><br><span class="line">+------+--------+-------+</span><br></pre></td></tr></table></figure>

<h3 id="42-查询课程编号为-01-且课程成绩在-80-分以上的学生的学号和姓名"><a href="#42-查询课程编号为-01-且课程成绩在-80-分以上的学生的学号和姓名" class="headerlink" title="42. 查询课程编号为 01 且课程成绩在 80 分以上的学生的学号和姓名"></a>42. 查询课程编号为 01 且课程成绩在 80 分以上的学生的学号和姓名</h3><p>解题思路：把分数表和学生表连接，使用WHERE过滤条件。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> st.SId, st.Sname</span><br><span class="line"><span class="keyword">FROM</span> Score <span class="keyword">AS</span> sc <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Student <span class="keyword">AS</span> st </span><br><span class="line"><span class="keyword">ON</span> st.SId = sc.SId</span><br><span class="line"><span class="keyword">WHERE</span> sc.CId = <span class="string">'01'</span> <span class="keyword">AND</span> sc.score &gt;= <span class="number">80</span>;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+</span><br><span class="line">| SId  | Sname  |</span><br><span class="line">+------+--------+</span><br><span class="line">| 01   | 赵雷   |</span><br><span class="line">| 03   | 孙风   |</span><br><span class="line">+------+--------+</span><br></pre></td></tr></table></figure>

<h3 id="43-成绩不重复，查询选修「张三」老师所授课程的学生中，成绩最高的学生信息及其成绩"><a href="#43-成绩不重复，查询选修「张三」老师所授课程的学生中，成绩最高的学生信息及其成绩" class="headerlink" title="43. 成绩不重复，查询选修「张三」老师所授课程的学生中，成绩最高的学生信息及其成绩"></a>43. 成绩不重复，查询选修「张三」老师所授课程的学生中，成绩最高的学生信息及其成绩</h3><p>解题思路：首先找出张三老师教的课程编号：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> co.CId</span><br><span class="line"><span class="keyword">FROM</span> Course <span class="keyword">AS</span> co <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Teacher <span class="keyword">AS</span> te</span><br><span class="line"><span class="keyword">ON</span> co.TId = te.TId</span><br><span class="line"><span class="keyword">WHERE</span> te.Tname = <span class="string">'张三'</span>;</span><br></pre></td></tr></table></figure>
<p>得到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+------+</span><br><span class="line">| CId  |</span><br><span class="line">+------+</span><br><span class="line">| 02   |</span><br><span class="line">+------+</span><br></pre></td></tr></table></figure>
<p>然后把学生表和成绩表连接，找出成绩表中课程编号是02的所有成绩，取最高的成绩及其学生信息。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> st.*, sc.score</span><br><span class="line"><span class="keyword">FROM</span> Student <span class="keyword">AS</span> st <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Score <span class="keyword">AS</span> sc</span><br><span class="line"><span class="keyword">ON</span> st.SId = sc.SId</span><br><span class="line"><span class="keyword">WHERE</span> sc.CId = (</span><br><span class="line">    <span class="keyword">SELECT</span> co.CId</span><br><span class="line">    <span class="keyword">FROM</span> Course <span class="keyword">AS</span> co <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Teacher <span class="keyword">AS</span> te</span><br><span class="line">    <span class="keyword">ON</span> co.TId = te.TId</span><br><span class="line">    <span class="keyword">WHERE</span> te.Tname = <span class="string">'张三'</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> sc.score <span class="keyword">DESC</span></span><br><span class="line"><span class="keyword">LIMIT</span> <span class="number">0</span>,<span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+-------+</span><br><span class="line">| SId  | Sname  | Sage                | Ssex | score |</span><br><span class="line">+------+--------+---------------------+------+-------+</span><br><span class="line">| 01   | 赵雷   | 1990-01-01 00:00:00 | 男   |  90.0 |</span><br><span class="line">+------+--------+---------------------+------+-------+</span><br></pre></td></tr></table></figure>

<h3 id="44-成绩有重复的情况下，查询选修「张三」老师所授课程的学生中，成绩最高的学生信息及其成绩"><a href="#44-成绩有重复的情况下，查询选修「张三」老师所授课程的学生中，成绩最高的学生信息及其成绩" class="headerlink" title="44. 成绩有重复的情况下，查询选修「张三」老师所授课程的学生中，成绩最高的学生信息及其成绩"></a>44. 成绩有重复的情况下，查询选修「张三」老师所授课程的学生中，成绩最高的学生信息及其成绩</h3><p>为了验证本题答案正确性，先把原Score表中的数据做下修改，设张三老师课程下有两个最高分的。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> Score <span class="keyword">SET</span> score=<span class="number">90</span></span><br><span class="line"><span class="keyword">where</span> <span class="keyword">SId</span> = <span class="string">"07"</span></span><br><span class="line"><span class="keyword">and</span> CId =<span class="string">"02"</span>;</span><br></pre></td></tr></table></figure>

<p>解题思路：和44题类似，首先找出张三老师教的课程编号，以及该课程下最高的分数：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> co.CId</span><br><span class="line"><span class="keyword">FROM</span> Course <span class="keyword">AS</span> co <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Teacher <span class="keyword">AS</span> te</span><br><span class="line"><span class="keyword">ON</span> co.TId = te.TId</span><br><span class="line"><span class="keyword">WHERE</span> te.Tname = <span class="string">'张三'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MAX</span>(score)</span><br><span class="line"><span class="keyword">FROM</span> Score</span><br><span class="line"><span class="keyword">WHERE</span> CId = (</span><br><span class="line">    <span class="keyword">SELECT</span> co.CId</span><br><span class="line">    <span class="keyword">FROM</span> Course <span class="keyword">AS</span> co <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Teacher <span class="keyword">AS</span> te</span><br><span class="line">    <span class="keyword">ON</span> co.TId = te.TId</span><br><span class="line">    <span class="keyword">WHERE</span> te.Tname = <span class="string">'张三'</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>得到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">+------+</span><br><span class="line">| CId  |</span><br><span class="line">+------+</span><br><span class="line">| 02   |</span><br><span class="line">+------+</span><br><span class="line"></span><br><span class="line">+------------+</span><br><span class="line">| MAX(score) |</span><br><span class="line">+------------+</span><br><span class="line">|       90.0 |</span><br><span class="line">+------------+</span><br></pre></td></tr></table></figure>
<p>然后，在分数表中筛选出满足这两个条件的：<br>第一，课程id是张三老师教课的课程id。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> st.*, sc.score, sc.CId</span><br><span class="line"><span class="keyword">FROM</span> Student <span class="keyword">AS</span> st <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Score <span class="keyword">AS</span> sc </span><br><span class="line"><span class="keyword">ON</span> st.SId = sc.SId</span><br><span class="line"><span class="keyword">WHERE</span> sc.CId = (</span><br><span class="line">    <span class="keyword">SELECT</span> co.CId</span><br><span class="line">    <span class="keyword">FROM</span> Course <span class="keyword">AS</span> co <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Teacher <span class="keyword">AS</span> te</span><br><span class="line">    <span class="keyword">ON</span> co.TId = te.TId</span><br><span class="line">    <span class="keyword">WHERE</span> te.Tname = <span class="string">'张三'</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>得到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+-------+------+</span><br><span class="line">| SId  | Sname  | Sage                | Ssex | score | CId  |</span><br><span class="line">+------+--------+---------------------+------+-------+------+</span><br><span class="line">| 01   | 赵雷   | 1990-01-01 00:00:00 | 男   |  90.0 | 02   |</span><br><span class="line">| 02   | 钱电   | 1990-12-21 00:00:00 | 男   |  60.0 | 02   |</span><br><span class="line">| 03   | 孙风   | 1990-12-20 00:00:00 | 男   |  80.0 | 02   |</span><br><span class="line">| 04   | 李云   | 1990-12-06 00:00:00 | 男   |  30.0 | 02   |</span><br><span class="line">| 05   | 周梅   | 1991-12-01 00:00:00 | 女   |  87.0 | 02   |</span><br><span class="line">| 07   | 郑竹   | 1989-01-01 00:00:00 | 女   |  90.0 | 02   |</span><br><span class="line">+------+--------+---------------------+------+-------+------+</span><br></pre></td></tr></table></figure>

<p>第二, 在这个表基础上，找出分数是最高分的</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> st.*, sc.score, sc.CId</span><br><span class="line"><span class="keyword">FROM</span> Student <span class="keyword">AS</span> st <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Score <span class="keyword">AS</span> sc </span><br><span class="line"><span class="keyword">ON</span> st.SId = sc.SId</span><br><span class="line"><span class="keyword">WHERE</span> sc.CId = (</span><br><span class="line">    <span class="keyword">SELECT</span> co.CId</span><br><span class="line">    <span class="keyword">FROM</span> Course <span class="keyword">AS</span> co <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Teacher <span class="keyword">AS</span> te</span><br><span class="line">    <span class="keyword">ON</span> co.TId = te.TId</span><br><span class="line">    <span class="keyword">WHERE</span> te.Tname = <span class="string">'张三'</span></span><br><span class="line">) <span class="keyword">AND</span> sc.score <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">MAX</span>(score)</span><br><span class="line">    <span class="keyword">FROM</span> Score</span><br><span class="line">    <span class="keyword">WHERE</span> CId = (</span><br><span class="line">        <span class="keyword">SELECT</span> co.CId</span><br><span class="line">        <span class="keyword">FROM</span> Course <span class="keyword">AS</span> co <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Teacher <span class="keyword">AS</span> te</span><br><span class="line">        <span class="keyword">ON</span> co.TId = te.TId</span><br><span class="line">        <span class="keyword">WHERE</span> te.Tname = <span class="string">'张三'</span></span><br><span class="line">    )</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+-------+------+</span><br><span class="line">| SId  | Sname  | Sage                | Ssex | score | CId  |</span><br><span class="line">+------+--------+---------------------+------+-------+------+</span><br><span class="line">| 01   | 赵雷   | 1990-01-01 00:00:00 | 男   |  90.0 | 02   |</span><br><span class="line">| 07   | 郑竹   | 1989-01-01 00:00:00 | 女   |  90.0 | 02   |</span><br><span class="line">+------+--------+---------------------+------+-------+------+</span><br></pre></td></tr></table></figure>

<p>最后记得把表恢复到原表的成绩：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> Score <span class="keyword">SET</span> score=<span class="number">89</span></span><br><span class="line"><span class="keyword">where</span> <span class="keyword">SId</span> = <span class="string">"07"</span></span><br><span class="line"><span class="keyword">and</span> CId =<span class="string">"02"</span>;</span><br></pre></td></tr></table></figure>

<h3 id="45-查询不同课程成绩相同的学生的学生编号、课程编号、学生成绩"><a href="#45-查询不同课程成绩相同的学生的学生编号、课程编号、学生成绩" class="headerlink" title="45. 查询不同课程成绩相同的学生的学生编号、课程编号、学生成绩"></a>45. 查询不同课程成绩相同的学生的学生编号、课程编号、学生成绩</h3><p>解题思路：首先把分数表自连接成两份sc1和sc2，连接条件设为sc1.score = sc1.score 和 sc1.CId != sc2.CId，</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sc1.SId, sc1.CId, sc1.score</span><br><span class="line"><span class="keyword">FROM</span> Score <span class="keyword">AS</span> sc1 <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Score <span class="keyword">AS</span> sc2</span><br><span class="line"><span class="keyword">ON</span> sc1.score = sc2.score <span class="keyword">AND</span> sc1.CId != sc2.CId;</span><br></pre></td></tr></table></figure>

<p>得到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">+------+------+-------+</span><br><span class="line">| SId  | CId  | score |</span><br><span class="line">+------+------+-------+</span><br><span class="line">| 03   | 02   |  80.0 |</span><br><span class="line">| 02   | 03   |  80.0 |</span><br><span class="line">| 03   | 03   |  80.0 |</span><br><span class="line">| 03   | 02   |  80.0 |</span><br><span class="line">| 02   | 03   |  80.0 |</span><br><span class="line">| 03   | 03   |  80.0 |</span><br><span class="line">| 01   | 01   |  80.0 |</span><br><span class="line">| 03   | 01   |  80.0 |</span><br><span class="line">| 02   | 03   |  80.0 |</span><br><span class="line">| 03   | 03   |  80.0 |</span><br><span class="line">| 01   | 01   |  80.0 |</span><br><span class="line">| 03   | 01   |  80.0 |</span><br><span class="line">| 03   | 02   |  80.0 |</span><br><span class="line">| 01   | 01   |  80.0 |</span><br><span class="line">| 03   | 01   |  80.0 |</span><br><span class="line">| 03   | 02   |  80.0 |</span><br><span class="line">+------+------+-------+</span><br></pre></td></tr></table></figure>
<p>然后对SId去重，<br>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> sc1.SId, sc1.CId, sc1.score</span><br><span class="line"><span class="keyword">FROM</span> Score <span class="keyword">AS</span> sc1 <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Score <span class="keyword">AS</span> sc2</span><br><span class="line"><span class="keyword">ON</span> sc1.score = sc2.score <span class="keyword">AND</span> sc1.CId != sc2.CId</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+------+------+-------+</span><br><span class="line">| SId  | CId  | score |</span><br><span class="line">+------+------+-------+</span><br><span class="line">| 03   | 02   |  80.0 |</span><br><span class="line">| 02   | 03   |  80.0 |</span><br><span class="line">| 03   | 03   |  80.0 |</span><br><span class="line">| 01   | 01   |  80.0 |</span><br><span class="line">| 03   | 01   |  80.0 |</span><br><span class="line">+------+------+-------+</span><br></pre></td></tr></table></figure>
<h3 id="46-统计每门课程的学生选修人数（超过5人的课程才统计）。要求输出课程号和选修人数，查询结果按人数降序排列，若人数相同，按课程号升序排列（不重要）"><a href="#46-统计每门课程的学生选修人数（超过5人的课程才统计）。要求输出课程号和选修人数，查询结果按人数降序排列，若人数相同，按课程号升序排列（不重要）" class="headerlink" title="46. 统计每门课程的学生选修人数（超过5人的课程才统计）。要求输出课程号和选修人数，查询结果按人数降序排列，若人数相同，按课程号升序排列（不重要）"></a>46. 统计每门课程的学生选修人数（超过5人的课程才统计）。要求输出课程号和选修人数，查询结果按人数降序排列，若人数相同，按课程号升序排列（不重要）</h3><p>解题思路：对课程进行分组，分组条件设为人数&gt;5。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> CId, <span class="keyword">COUNT</span>(<span class="keyword">SId</span>) <span class="keyword">AS</span> <span class="string">'student_num'</span></span><br><span class="line"><span class="keyword">FROM</span> Score</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> CId</span><br><span class="line"><span class="keyword">HAVING</span> student_num &gt; <span class="number">5</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> student_num <span class="keyword">DESC</span>, CId;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+------+-------------+</span><br><span class="line">| CId  | student_num |</span><br><span class="line">+------+-------------+</span><br><span class="line">| 01   |           6 |</span><br><span class="line">| 02   |           6 |</span><br><span class="line">| 03   |           6 |</span><br><span class="line">+------+-------------+</span><br></pre></td></tr></table></figure>


<h3 id="47-检索至少选修两门课程的学生学号"><a href="#47-检索至少选修两门课程的学生学号" class="headerlink" title="47. 检索至少选修两门课程的学生学号"></a>47. 检索至少选修两门课程的学生学号</h3><p>解题思路：对分数表中的学生分组，分组条件设为课程数量&gt;=2。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">SId</span></span><br><span class="line"><span class="keyword">FROM</span> Score</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">SId</span></span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(CId) &gt;= <span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">+------+</span><br><span class="line">| SId  |</span><br><span class="line">+------+</span><br><span class="line">| 01   |</span><br><span class="line">| 02   |</span><br><span class="line">| 03   |</span><br><span class="line">| 04   |</span><br><span class="line">| 05   |</span><br><span class="line">| 06   |</span><br><span class="line">| 07   |</span><br><span class="line">+------+</span><br></pre></td></tr></table></figure>

<h3 id="48-查询选修了全部课程的学生信息"><a href="#48-查询选修了全部课程的学生信息" class="headerlink" title="48. 查询选修了全部课程的学生信息"></a>48. 查询选修了全部课程的学生信息</h3><p>解题思路：先找出课程表中全部课程总共有多少。然后把学生表和分数表连接，并对学生进行分组，分组后对每个学生设置过滤条件，即该学生选修课程数量=全部课程数量。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> st.SId, st.Sname, st.Sage, st.Ssex</span><br><span class="line"><span class="keyword">FROM</span> Student <span class="keyword">AS</span> st <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Score <span class="keyword">AS</span> sc</span><br><span class="line"><span class="keyword">ON</span> st.SId = sc.SId</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> st.SId, st.Sname, st.Sage, st.Ssex</span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(sc.CId) = (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(CId)</span><br><span class="line">    <span class="keyword">FROM</span> Course</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+</span><br><span class="line">| SId  | Sname  | Sage                | Ssex |</span><br><span class="line">+------+--------+---------------------+------+</span><br><span class="line">| 01   | 赵雷   | 1990-01-01 00:00:00 | 男   |</span><br><span class="line">| 02   | 钱电   | 1990-12-21 00:00:00 | 男   |</span><br><span class="line">| 03   | 孙风   | 1990-12-20 00:00:00 | 男   |</span><br><span class="line">| 04   | 李云   | 1990-12-06 00:00:00 | 男   |</span><br><span class="line">+------+--------+---------------------+------+</span><br></pre></td></tr></table></figure>

<h3 id="49-查询没学过“张三”老师讲授的任一门课程的学生姓名"><a href="#49-查询没学过“张三”老师讲授的任一门课程的学生姓名" class="headerlink" title="49.查询没学过“张三”老师讲授的任一门课程的学生姓名"></a>49.查询没学过“张三”老师讲授的任一门课程的学生姓名</h3><p>解题思路：首先找出张三讲授的所有课程的id:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> co.CId</span><br><span class="line"><span class="keyword">FROM</span> Course <span class="keyword">AS</span> co <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Teacher <span class="keyword">AS</span> te</span><br><span class="line"><span class="keyword">ON</span> co.TId = te.TId</span><br><span class="line"><span class="keyword">WHERE</span> te.Tname = <span class="string">'张三'</span>;</span><br></pre></td></tr></table></figure>
<p>得到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+------+</span><br><span class="line">| CId  |</span><br><span class="line">+------+</span><br><span class="line">| 02   |</span><br><span class="line">+------+</span><br></pre></td></tr></table></figure>

<p>然后，把学生表和成绩表连接：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> Student <span class="keyword">AS</span> st <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Score <span class="keyword">AS</span> sc</span><br><span class="line"><span class="keyword">ON</span> st.SId = sc.SId;</span><br></pre></td></tr></table></figure>
<p>得到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+------+------+-------+</span><br><span class="line">| SId  | Sname  | Sage                | Ssex | SId  | CId  | score |</span><br><span class="line">+------+--------+---------------------+------+------+------+-------+</span><br><span class="line">| 01   | 赵雷   | 1990-01-01 00:00:00 | 男   | 01   | 01   |  80.0 |</span><br><span class="line">| 01   | 赵雷   | 1990-01-01 00:00:00 | 男   | 01   | 02   |  90.0 |</span><br><span class="line">| 02   | 钱电   | 1990-12-21 00:00:00 | 男   | 02   | 01   |  70.0 |</span><br><span class="line">| 02   | 钱电   | 1990-12-21 00:00:00 | 男   | 02   | 02   |  60.0 |</span><br><span class="line">| 03   | 孙风   | 1990-12-20 00:00:00 | 男   | 03   | 01   |  80.0 |</span><br><span class="line">| 03   | 孙风   | 1990-12-20 00:00:00 | 男   | 03   | 02   |  80.0 |</span><br><span class="line">| 04   | 李云   | 1990-12-06 00:00:00 | 男   | 04   | 01   |  50.0 |</span><br><span class="line">| 04   | 李云   | 1990-12-06 00:00:00 | 男   | 04   | 02   |  30.0 |</span><br><span class="line">| 05   | 周梅   | 1991-12-01 00:00:00 | 女   | 05   | 01   |  76.0 |</span><br><span class="line">| 05   | 周梅   | 1991-12-01 00:00:00 | 女   | 05   | 02   |  87.0 |</span><br><span class="line">| 06   | 吴兰   | 1992-01-01 00:00:00 | 女   | 06   | 01   |  31.0 |</span><br><span class="line">| 07   | 郑竹   | 1989-01-01 00:00:00 | 女   | 07   | 02   |  89.0 |</span><br><span class="line">| 01   | 赵雷   | 1990-01-01 00:00:00 | 男   | 01   | 03   |  99.0 |</span><br><span class="line">| 02   | 钱电   | 1990-12-21 00:00:00 | 男   | 02   | 03   |  80.0 |</span><br><span class="line">| 03   | 孙风   | 1990-12-20 00:00:00 | 男   | 03   | 03   |  80.0 |</span><br><span class="line">| 04   | 李云   | 1990-12-06 00:00:00 | 男   | 04   | 03   |  20.0 |</span><br><span class="line">| 06   | 吴兰   | 1992-01-01 00:00:00 | 女   | 06   | 03   |  34.0 |</span><br><span class="line">| 07   | 郑竹   | 1989-01-01 00:00:00 | 女   | 07   | 03   |  98.0 |</span><br><span class="line">+------+--------+---------------------+------+------+------+-------+</span><br></pre></td></tr></table></figure>

<p>在这张表中，找出所有学过ID为02课程的学生。先对学生及其分数分组，设置过滤条件为学过ID为02课程的学生</p>
<p>找出所有学过课程id为02的学生：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> st.SId, st.Sname</span><br><span class="line"><span class="keyword">FROM</span> Student <span class="keyword">AS</span> st <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Score <span class="keyword">AS</span> sc</span><br><span class="line"><span class="keyword">ON</span> st.SId = sc.SId</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> st.SId, st.Sname,sc.CId</span><br><span class="line"><span class="keyword">HAVING</span> sc.CId <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> co.CId</span><br><span class="line">    <span class="keyword">FROM</span> Course <span class="keyword">AS</span> co <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Teacher <span class="keyword">AS</span> te</span><br><span class="line">    <span class="keyword">ON</span> co.TId = te.TId</span><br><span class="line">    <span class="keyword">WHERE</span> te.Tname = <span class="string">'张三'</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>得到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+</span><br><span class="line">| SId  | Sname  |</span><br><span class="line">+------+--------+</span><br><span class="line">| 01   | 赵雷   |</span><br><span class="line">| 02   | 钱电   |</span><br><span class="line">| 03   | 孙风   |</span><br><span class="line">| 04   | 李云   |</span><br><span class="line">| 05   | 周梅   |</span><br><span class="line">| 07   | 郑竹   |</span><br><span class="line">+------+--------+</span><br></pre></td></tr></table></figure>
<p>最后，在学生表中，把这些学生排除掉，得到的就是没有学过“张三”老师讲授的任一门课程的学生姓名</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">SId</span>, Sname</span><br><span class="line"><span class="keyword">FROM</span> Student </span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">SId</span> <span class="keyword">NOT</span> <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> st.SId</span><br><span class="line">    <span class="keyword">FROM</span> Student <span class="keyword">AS</span> st <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Score <span class="keyword">AS</span> sc</span><br><span class="line">    <span class="keyword">ON</span> st.SId = sc.SId</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> st.SId, st.Sname,sc.CId</span><br><span class="line">    <span class="keyword">HAVING</span> sc.CId <span class="keyword">IN</span> (</span><br><span class="line">        <span class="keyword">SELECT</span> co.CId</span><br><span class="line">        <span class="keyword">FROM</span> Course <span class="keyword">AS</span> co <span class="keyword">INNER</span> <span class="keyword">JOIN</span> Teacher <span class="keyword">AS</span> te</span><br><span class="line">        <span class="keyword">ON</span> co.TId = te.TId</span><br><span class="line">        <span class="keyword">WHERE</span> te.Tname = <span class="string">'张三'</span></span><br><span class="line">    )</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>最后结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+</span><br><span class="line">| SId  | Sname  |</span><br><span class="line">+------+--------+</span><br><span class="line">| 06   | 吴兰   |</span><br><span class="line">| 09   | 张三   |</span><br><span class="line">| 10   | 李四   |</span><br><span class="line">| 11   | 李四   |</span><br><span class="line">| 12   | 赵六   |</span><br><span class="line">| 13   | 孙七   |</span><br><span class="line">+------+--------+</span><br></pre></td></tr></table></figure>

<h3 id="50-查询两门以上不及格课程的同学的学号及其平均成绩"><a href="#50-查询两门以上不及格课程的同学的学号及其平均成绩" class="headerlink" title="50. 查询两门以上不及格课程的同学的学号及其平均成绩"></a>50. 查询两门以上不及格课程的同学的学号及其平均成绩</h3><p>解题思路：首先查出所有不及格的,再对学生分组，分组条件设为课程&gt;2的。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">SId</span>, <span class="keyword">AVG</span>(score) <span class="keyword">as</span> avg_score</span><br><span class="line"><span class="keyword">FROM</span> Score</span><br><span class="line"><span class="keyword">WHERE</span> score &lt; <span class="number">60</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">SId</span></span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(CId) &gt; <span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+------+-----------+</span><br><span class="line">| SId  | avg_score |</span><br><span class="line">+------+-----------+</span><br><span class="line">| 04   |  33.33333 |</span><br><span class="line">+------+-----------+</span><br></pre></td></tr></table></figure>

<h3 id="51-查询各学生的年龄，只按年份来算"><a href="#51-查询各学生的年龄，只按年份来算" class="headerlink" title="51. 查询各学生的年龄，只按年份来算"></a>51. 查询各学生的年龄，只按年份来算</h3><p>解题思路：使用YEAR()函数计算每个日期的年份，</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Sname, Sage, <span class="keyword">YEAR</span>(<span class="keyword">now</span>()) - <span class="keyword">YEAR</span>(Sage) <span class="keyword">as</span> <span class="string">'年龄'</span></span><br><span class="line"><span class="keyword">FROM</span> Student;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">+--------+---------------------+--------+</span><br><span class="line">| Sname  | Sage                | 年龄   |</span><br><span class="line">+--------+---------------------+--------+</span><br><span class="line">| 赵雷   | 1990-01-01 00:00:00 |     29 |</span><br><span class="line">| 钱电   | 1990-12-21 00:00:00 |     29 |</span><br><span class="line">| 孙风   | 1990-12-20 00:00:00 |     29 |</span><br><span class="line">| 李云   | 1990-12-06 00:00:00 |     29 |</span><br><span class="line">| 周梅   | 1991-12-01 00:00:00 |     28 |</span><br><span class="line">| 吴兰   | 1992-01-01 00:00:00 |     27 |</span><br><span class="line">| 郑竹   | 1989-01-01 00:00:00 |     30 |</span><br><span class="line">| 张三   | 2017-12-20 00:00:00 |      2 |</span><br><span class="line">| 李四   | 2017-12-25 00:00:00 |      2 |</span><br><span class="line">| 李四   | 2012-06-06 00:00:00 |      7 |</span><br><span class="line">| 赵六   | 2013-06-13 00:00:00 |      6 |</span><br><span class="line">| 孙七   | 2014-06-01 00:00:00 |      5 |</span><br><span class="line">+--------+---------------------+--------+</span><br></pre></td></tr></table></figure>

<h3 id="52-查询各学生的年龄，按出生日期算，当前月日-lt-出生年月的月日，则年龄减一"><a href="#52-查询各学生的年龄，按出生日期算，当前月日-lt-出生年月的月日，则年龄减一" class="headerlink" title="52. 查询各学生的年龄，按出生日期算，当前月日 &lt; 出生年月的月日，则年龄减一"></a>52. 查询各学生的年龄，按出生日期算，当前月日 &lt; 出生年月的月日，则年龄减一</h3><p>解题思路：这个题目和52题不一样的地方在于，年龄需要加入月日的判断。<br>今天是2019年11月10日。<br>假如出生日期是2017年6月1日，当前月日11-10 &gt; 出生月日06-01，ta现在的年龄是2019-11-10减去2017-06-01，结果是2岁<br>假如出生日期是2017年12月1日， 当前月日11-10 &lt; 出生月日12-01，ta现在的年龄是(2019-11-10减去2017-12-01)再减去1，结果是1岁</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> </span><br><span class="line">    Sname,</span><br><span class="line">    Sage,</span><br><span class="line">    (<span class="keyword">DATE_FORMAT</span>(<span class="keyword">NOW</span>(),<span class="string">'%Y'</span>) - <span class="keyword">DATE_FORMAT</span>(Sage,<span class="string">'%Y'</span>) - </span><br><span class="line">     (<span class="keyword">case</span> <span class="keyword">when</span> </span><br><span class="line">        <span class="keyword">DATE_FORMAT</span>(<span class="keyword">NOW</span>(),<span class="string">'%m%d'</span>) &lt; <span class="keyword">DATE_FORMAT</span>(Sage,<span class="string">'%m%d'</span>) </span><br><span class="line">        <span class="keyword">then</span> <span class="number">1</span> </span><br><span class="line">        <span class="keyword">else</span> <span class="number">0</span> </span><br><span class="line">     <span class="keyword">end</span>)</span><br><span class="line">    ) <span class="keyword">as</span> age</span><br><span class="line"><span class="keyword">from</span> Student;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">+--------+---------------------+------+</span><br><span class="line">| Sname  | Sage                | age  |</span><br><span class="line">+--------+---------------------+------+</span><br><span class="line">| 赵雷   | 1990-01-01 00:00:00 |   29 |</span><br><span class="line">| 钱电   | 1990-12-21 00:00:00 |   28 |</span><br><span class="line">| 孙风   | 1990-12-20 00:00:00 |   28 |</span><br><span class="line">| 李云   | 1990-12-06 00:00:00 |   28 |</span><br><span class="line">| 周梅   | 1991-12-01 00:00:00 |   27 |</span><br><span class="line">| 吴兰   | 1992-01-01 00:00:00 |   27 |</span><br><span class="line">| 郑竹   | 1989-01-01 00:00:00 |   30 |</span><br><span class="line">| 张三   | 2017-12-20 00:00:00 |    1 |</span><br><span class="line">| 李四   | 2017-12-25 00:00:00 |    1 |</span><br><span class="line">| 李四   | 2012-06-06 00:00:00 |    7 |</span><br><span class="line">| 赵六   | 2013-06-13 00:00:00 |    6 |</span><br><span class="line">| 孙七   | 2014-06-01 00:00:00 |    5 |</span><br></pre></td></tr></table></figure>

<h3 id="53-查询本周过生日的学生"><a href="#53-查询本周过生日的学生" class="headerlink" title="53. 查询本周过生日的学生"></a>53. 查询本周过生日的学生</h3><p>解题思路：使用week()函数，查出今天是第几周</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">WEEK</span>(<span class="keyword">NOW</span>());</span><br></pre></td></tr></table></figure>
<p>得到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+-------------+</span><br><span class="line">| WEEK(NOW()) |</span><br><span class="line">+-------------+</span><br><span class="line">|          45 |</span><br><span class="line">+-------------+</span><br></pre></td></tr></table></figure>
<p>学生表中的出生日期的第n周 = 今天的第n周<br>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *, <span class="keyword">week</span>(Sage) <span class="keyword">AS</span> <span class="string">'出生在第几周'</span></span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">WEEK</span>(<span class="keyword">NOW</span>()) = <span class="keyword">WEEK</span>(Sage);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Empty set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="54-查询下周过生日的学生"><a href="#54-查询下周过生日的学生" class="headerlink" title="54. 查询下周过生日的学生"></a>54. 查询下周过生日的学生</h3><p>解题思路：和54题类似。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *, <span class="keyword">week</span>(Sage) <span class="keyword">AS</span> <span class="string">'出生在第几周'</span></span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">WEEK</span>(<span class="keyword">NOW</span>()+<span class="number">1</span>) = <span class="keyword">WEEK</span>(Sage);</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Empty set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="55-查询本月过生日的学生"><a href="#55-查询本月过生日的学生" class="headerlink" title="55. 查询本月过生日的学生"></a>55. 查询本月过生日的学生</h3><p>解题思路：首先找出现在是几月：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MONTH</span>(<span class="keyword">NOW</span>());</span><br></pre></td></tr></table></figure>
<p>得到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+--------------+</span><br><span class="line">| MONTH(NOW()) |</span><br><span class="line">+--------------+</span><br><span class="line">|           11 |</span><br><span class="line">+--------------+</span><br></pre></td></tr></table></figure>
<p>然后，在学生表中，找出出生月份是和本月月份相同的。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *, <span class="keyword">MONTH</span>(Sage)</span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">MONTH</span>(Sage) = <span class="keyword">MONTH</span>(<span class="keyword">NOW</span>());</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Empty set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="56-查询下月过生日的学生"><a href="#56-查询下月过生日的学生" class="headerlink" title="56. 查询下月过生日的学生"></a>56. 查询下月过生日的学生</h3><p>解题思路：和56题类似，只不过月份需要加1。</p>
<p>代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *, <span class="keyword">MONTH</span>(Sage) <span class="keyword">AS</span> <span class="string">'出生月份'</span></span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">MONTH</span>(Sage) = <span class="keyword">MONTH</span>(<span class="keyword">NOW</span>())+<span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+------+--------+---------------------+------+--------------+</span><br><span class="line">| SId  | Sname  | Sage                | Ssex | 出生月份     |</span><br><span class="line">+------+--------+---------------------+------+--------------+</span><br><span class="line">| 02   | 钱电   | 1990-12-21 00:00:00 | 男   |           12 |</span><br><span class="line">| 03   | 孙风   | 1990-12-20 00:00:00 | 男   |           12 |</span><br><span class="line">| 04   | 李云   | 1990-12-06 00:00:00 | 男   |           12 |</span><br><span class="line">| 05   | 周梅   | 1991-12-01 00:00:00 | 女   |           12 |</span><br><span class="line">| 09   | 张三   | 2017-12-20 00:00:00 | 女   |           12 |</span><br><span class="line">| 10   | 李四   | 2017-12-25 00:00:00 | 女   |           12 |</span><br><span class="line">+------+--------+---------------------+------+--------------+</span><br></pre></td></tr></table></figure>
</div></div><div id="disqus_thread"><div class="btn_click_load"><button class="disqus_click_btn">阅读评论（请确保 Disqus 可以正常加载）</button></div><script type="text/javascript">var disqus_config = function () {
    this.page.url = 'http://huanyouchen.github.io/2019/11/07/sql-exercises-50/';
    this.page.identifier = '2019/11/07/sql-exercises-50/';
    this.page.title = 'sql常见面试50题练习';
  };</script><script type="text/javascript" id="disqus-lazy-load-script">$.ajax({
url: 'https://disqus.com/next/config.json',
timeout: 2500,
type: 'GET',
success: function(){
  var d = document;
  var s = d.createElement('script');
  s.src = '//huanyouchen-blog.disqus.com/embed.js';
  s.setAttribute('data-timestamp', + new Date());
  (d.head || d.body).appendChild(s);
  $('.disqus_click_btn').css('display', 'none');
},
error: function() {
  $('.disqus_click_btn').css('display', 'block');
}
});</script><script type="text/javascript" id="disqus-click-load">$('.btn_click_load').click(() => {  //click to load comments
    (() => { // DON'T EDIT BELOW THIS LINE
        var d = document;
        var s = d.createElement('script');
        s.src = '//huanyouchen-blog.disqus.com/embed.js';
        s.setAttribute('data-timestamp', + new Date());
        (d.head || d.body).appendChild(s);
    })();
    $('.disqus_click_btn').css('display','none');
});</script><script type="text/javascript" id="disqus-count-script">$(function() {
     var xhr = new XMLHttpRequest();
     xhr.open('GET', '//disqus.com/next/config.json', true);
     xhr.timeout = 2500;
     xhr.onreadystatechange = function () {
       if (xhr.readyState === 4 && xhr.status === 200) {
         $('.post-meta .post-comments-count').show();
         var s = document.createElement('script');
         s.id = 'dsq-count-scr';
         s.src = 'https://huanyouchen-blog.disqus.com/count.js';
         s.async = true;
         (document.head || document.body).appendChild(s);
       }
     };
     xhr.ontimeout = function () { xhr.abort(); };
     xhr.send(null);
   });
</script></div></div></div><div class="pure-u-1 pure-u-md-4-4"><div id="footer">Copyright © 2020 <a href="/." rel="nofollow">幻悠尘的小窝.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.css"><script type="text/javascript" src="/js/copycode.js" successtext="复制成功!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>